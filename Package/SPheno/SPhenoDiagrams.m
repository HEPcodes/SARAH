(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



DrawBoxDiagram[t1_,t2_,t3_,t4_,p1_,p2_,p3_,p4_,ins_,nr_,states_,name_,file_]:=Block[{nameIn1,nameIn2,nameIn3,nameIn4,nameOut1,nameOut2,nameOut3,nameOut4,line1,line2,line3,line4},

Switch[getType[p1],
S,line1="dashes";,
V,line1="wiggly";,
F,line1="plain";
];

Switch[getType[p2],
S,line2="dashes";,
V,line2="wiggly";,
F,line2="plain";
];

Switch[getType[p3],
S,line3="dashes";,
V,line3="wiggly";,
F,line3="plain";
];

Switch[getType[p4],
S,line4="dashes";,
V,line4="wiggly";,
F,line4="plain";
];

nameIn1=If[getGen[p1]>1,TeXOutput[p1],TeXOutput[p1 /.a_[{b_}]->a]];
nameIn2=If[getGen[p2]>1,TeXOutput[p2],TeXOutput[p2 /.a_[{b_}]->a]];
nameIn3=If[getGen[p3]>1,TeXOutput[p3],TeXOutput[p3 /.a_[{b_}]->a]];
nameIn4=If[getGen[p4]>1,TeXOutput[p4],TeXOutput[p4 /.a_[{b_}]->a]];

nameOut1=If[getGen[t1]>1,TeXOutput[t1],TeXOutput[t1 /.a_[{b_}]->a]];
nameOut2=If[getGen[t2]>1,TeXOutput[t2],TeXOutput[t2 /.a_[{b_}]->a]];
nameOut3=If[getGen[t3]>1,TeXOutput[t3],TeXOutput[t3 /.a_[{b_}]->a]];
nameOut4=If[getGen[t4]>1,TeXOutput[t4],TeXOutput[t4 /.a_[{b_}]->a]];

WriteString[file,"\n\n \\begin{center}\n"];
Switch[ins,
1,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>ToString[states]<>"Box"<>ToString[nr]<>"} \n"];
 WriteString[file,"\\fmfframe(20,20)(20,20){ \n"];
WriteString[file,"\\begin{fmfgraph*}(100,60) \n"];
WriteString[file,"\\fmftop{t1,t2}\n"];
WriteString[file,"\\fmfbottom{b1,b2}\n"];
WriteString[file,"\\fmf{plain}{t1,v1}\n"];
WriteString[file,"\\fmf{"<>line1<>",label=$"<>nameIn1<>"$,tension=0.5}{v1,v2}\n"];
WriteString[file,"\\fmf{plain}{v2,t2}\n"];
WriteString[file,"\\fmf{plain}{b1,v3}\n"];
WriteString[file,"\\fmf{"<>line3<>",label=$"<>nameIn3<>"$,tension=0.5}{v3,v4}\n"];
WriteString[file,"\\fmf{plain}{v4,b2}\n"];
WriteString[file,"\\fmf{"<>line4<>",label=$"<>nameIn4<>"$,tension=0.1}{v1,v3}\n"];
WriteString[file,"\\fmf{"<>line2<>",label=$"<>nameIn2<>"$,tension=0.1}{v2,v4}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{t1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{t2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut3<>"$}{b2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut4<>"$}{b1}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];,
3,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>ToString[states]<>"Box"<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(100,60)\n"];
WriteString[file,"\\fmftop{t1,t2}\n"];
WriteString[file,"\\fmfbottom{b1,b2}\n"];
WriteString[file,"\\fmf{plain}{t1,v1}\n"];
WriteString[file,"\\fmf{"<>line1<>",label=$"<>nameIn1<>"$,tension=0.5}{v1,v2}\n"];
WriteString[file,"\\fmf{phantom}{v2,t2}\n"];
WriteString[file,"\\fmf{plain}{b1,v3}\n"];
WriteString[file,"\\fmf{"<>line3<>",label=$"<>nameIn3<>"$,tension=0.5}{v3,v4}\n"];
WriteString[file,"\\fmf{phantom}{v4,b2}\n"];
WriteString[file,"\\fmf{"<>line4<>",label=$"<>nameIn4<>"$,tension=0.1}{v1,v3}\n"];
WriteString[file,"\\fmf{"<>line2<>",label=$"<>nameIn2<>"$,tension=0.1}{v2,v4}\n"];
WriteString[file,"\\fmffreeze \n"];
WriteString[file,"\\fmf{plain}{v4,t2}\n"];
WriteString[file,"\\fmf{plain}{v2,b2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{t1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{b2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut3<>"$}{t2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut4<>"$}{b1}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];,
2,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>ToString[states]<>"Box"<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(100,60)\n"];
WriteString[file,"\\fmftop{t1,t2}\n"];
WriteString[file,"\\fmfbottom{b1,b2}\n"];
WriteString[file,"\\fmf{plain}{t1,v1}\n"];
WriteString[file,"\\fmf{"<>line1<>",label=$"<>nameIn1<>"$,tension=0.5}{v1,v2}\n"];
WriteString[file,"\\fmf{plain}{v2,t2}\n"];
WriteString[file,"\\fmf{phantom}{b1,v3}\n"];
WriteString[file,"\\fmf{"<>line3<>",label=$"<>nameIn3<>"$,tension=0.5}{v3,v4}\n"];
WriteString[file,"\\fmf{phantom}{v4,b2}\n"];
WriteString[file,"\\fmf{"<>line4<>",label=$"<>nameIn4<>"$,tension=0.1}{v1,v3}\n"];
WriteString[file,"\\fmf{"<>line2<>",label=$"<>nameIn2<>"$,tension=0.1}{v2,v4}\n"];
WriteString[file,"\\fmffreeze\n"];
WriteString[file,"\\fmf{plain}{v4,b1}\n"];
WriteString[file,"\\fmf{plain}{v3,b2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{t1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{t2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut3<>"$}{b1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut4<>"$}{b2}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];
];
WriteString[file,"\\end{center}\n\n"];
];


DrawPenguinDiagram[t1_,t2_,t3_,t4_,p1_,p2_,p3_,prop_,ins_,nr_,states_,name_,file_]:=Block[{nameIn1,nameIn2,nameIn3,nameProp,nameOut1,nameOut2,nameOut3,nameOut4,line1,line2,line3,lineProp},

Switch[getType[p1],
S,line1="dashes";,
V,line1="wiggly";,
F,line1="plain";
];

Switch[getType[p2],
S,line2="dashes";,
V,line2="wiggly";,
F,line2="plain";
];

Switch[getType[p3],
S,line3="dashes";,
V,line3="wiggly";,
F,line3="plain";
];

Switch[getType[prop],
S,lineProp="dashes";,
V,lineProp="wiggly";,
F,lineProp="plain";
];

nameIn1=If[getGen[p1]>1,TeXOutput[p1],TeXOutput[p1 /.a_[{b_}]->a]];
nameIn2=If[getGen[p2]>1,TeXOutput[p2],TeXOutput[p2 /.a_[{b_}]->a]];
nameIn3=If[getGen[p3]>1,TeXOutput[p3],TeXOutput[p3 /.a_[{b_}]->a]];
nameProp=If[getGen[prop]>1,TeXOutput[prop],TeXOutput[prop /.a_[{b_}]->a]];


nameOut1=If[getGen[t1]>1,TeXOutput[t1],TeXOutput[t1 /.a_[{b_}]->a]];
nameOut2=If[getGen[t2]>1,TeXOutput[t2],TeXOutput[t2 /.a_[{b_}]->a]];
nameOut3=If[getGen[t3]>1,TeXOutput[t3],TeXOutput[t3 /.a_[{b_}]->a]];
nameOut4=If[getGen[t4]>1,TeXOutput[t4],TeXOutput[t4 /.a_[{b_}]->a]];



WriteString[file,"\n\n \\begin{center}\n"];
Switch[ins,
1,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>"Penguin"<>ToString[states]<>ToString[getBlank[prop]]<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(150,75)\n"];
WriteString[file,"\\fmfleft{l1,l2}\n"];
WriteString[file,"\\fmfright{r1,r2}\n"];
WriteString[file,"\\fmf{plain}{r1,v1}\n"];
WriteString[file,"\\fmf{plain}{v1,r2}\n"];
WriteString[file,"\\fmf{plain}{l1,v2}\n"];
WriteString[file,"\\fmf{"<>line3<>",label=$"<>nameIn3<>"$,tension=0.3}{v2,v3}\n"];
WriteString[file,"\\fmf{"<>line2<>",label=$"<>nameIn2<>"$,tension=0.3}{v3,v4}\n"];
WriteString[file,"\\fmf{plain}{v4,l2}\n"];
WriteString[file,"\\fmf{"<>lineProp<>",tension=1.0,label=$"<>nameProp<>"$}{v1,v3}\n"];
WriteString[file,"\\fmf{"<>line1<>",tension=0.1,label=$"<>nameIn1<>"$}{v2,v4}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{l2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{l1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut3<>"$}{r2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut4<>"$}{r1}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];,
2,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>"Penguin"<>ToString[states]<>ToString[getBlank[prop]]<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(150,75)\n"];
WriteString[file,"\\fmfleft{l1,l2}\n"];
WriteString[file,"\\fmfright{r1,r2}\n"];
WriteString[file,"\\fmf{plain}{r1,v1}\n"];
WriteString[file,"\\fmf{phantom}{v1,r2}\n"];
WriteString[file,"\\fmf{phantom}{l1,v2}\n"];
WriteString[file,"\\fmf{"<>line3<>",label=$"<>nameIn3<>"$,tension=0.3}{v2,v3}\n"];
WriteString[file,"\\fmf{"<>line2<>",label=$"<>nameIn2<>"$,tension=0.3}{v3,v4}\n"];
WriteString[file,"\\fmf{plain}{v4,l2} \n"];
WriteString[file,"\\fmf{"<>lineProp<>",tension=1.0,label=$"<>nameProp<>"$}{v1,v3}\n"];
WriteString[file,"\\fmf{"<>line1<>",tension=0.1,label=$"<>nameIn1<>"$}{v2,v4}\n"];
WriteString[file,"\\fmffreeze \n"];
WriteString[file,"\\fmf{plain}{v1,l1}\n"];
WriteString[file,"\\fmf{plain}{v2,r2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{l2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{l1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut3<>"$}{r2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut4<>"$}{r1}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];,
3,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>"Penguin"<>ToString[states]<>ToString[getBlank[prop]]<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(150,75)\n"];
WriteString[file,"\\fmfleft{l1,l2}\n"];
WriteString[file,"\\fmfright{r1,r2}\n"];
WriteString[file,"\\fmf{phantom}{r1,v1}\n"];
WriteString[file,"\\fmf{plain}{v1,r2}\n"];
WriteString[file,"\\fmf{phantom}{l1,v2}\n"];
WriteString[file,"\\fmf{"<>line3<>",label=$"<>nameIn3<>"$,tension=0.3}{v2,v3}\n"];
WriteString[file,"\\fmf{"<>line2<>",label=$"<>nameIn2<>"$,tension=0.3}{v3,v4}\n"];
WriteString[file,"\\fmf{plain}{v4,l2}\n"];
WriteString[file,"\\fmf{"<>lineProp<>",tension=1.0,label=$"<>nameProp<>"$}{v1,v3}\n"];
WriteString[file,"\\fmf{"<>line1<>",tension=0.1,label=$"<>nameIn1<>"$}{v2,v4}\n"];
WriteString[file,"\\fmffreeze \n"];
WriteString[file,"\\fmf{plain}{v1,l1}\n"];
WriteString[file,"\\fmf{plain}{v2,r1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{l2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{l1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut3<>"$}{r2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut4<>"$}{r1}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];,
4,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>"Penguin"<>ToString[states]<>ToString[getBlank[prop]]<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(150,75)\n"];
WriteString[file,"\\fmfright{l1,l2}\n"];
WriteString[file,"\\fmfleft{r1,r2}\n"];
WriteString[file,"\\fmf{plain}{r1,v1}\n"];
WriteString[file,"\\fmf{plain}{v1,r2}\n"];
WriteString[file,"\\fmf{plain}{l1,v2}\n"];
WriteString[file,"\\fmf{"<>line3<>",label=$"<>nameIn3<>"$,tension=0.3}{v2,v3}\n"];
WriteString[file,"\\fmf{"<>line2<>",label=$"<>nameIn2<>"$,tension=0.3}{v3,v4}\n"];
WriteString[file,"\\fmf{plain}{v4,l2}\n"];
WriteString[file,"\\fmf{"<>lineProp<>",tension=1.0,label=$"<>nameProp<>"$}{v1,v3}\n"];
WriteString[file,"\\fmf{"<>line1<>",tension=0.1,label=$"<>nameIn1<>"$}{v2,v4}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{r2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{r1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut3<>"$}{l2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut4<>"$}{l1}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];,
5,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>"Penguin"<>ToString[states]<>ToString[getBlank[prop]]<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(150,75)\n"];
WriteString[file,"\\fmfleft{l2,l1}\n"];
WriteString[file,"\\fmfright{r2,r1}\n"];
WriteString[file,"\\fmf{plain}{r1,v1}\n"];
WriteString[file,"\\fmf{phantom}{v1,r2}\n"];
WriteString[file,"\\fmf{phantom}{l1,v2}\n"];
WriteString[file,"\\fmf{"<>line3<>",label=$"<>nameIn3<>"$,tension=0.3}{v2,v3}\n"];
WriteString[file,"\\fmf{"<>line2<>",label=$"<>nameIn2<>"$,tension=0.3}{v3,v4}\n"];
WriteString[file,"\\fmf{plain}{v4,l2} \n"];
WriteString[file,"\\fmf{"<>lineProp<>",tension=1.0,label=$"<>nameProp<>"$}{v1,v3}\n"];
WriteString[file,"\\fmf{"<>line1<>",tension=0.1,label=$"<>nameIn1<>"$}{v2,v4}\n"];
WriteString[file,"\\fmffreeze \n"];
WriteString[file,"\\fmf{plain}{v1,l1}\n"];
WriteString[file,"\\fmf{plain}{v2,r2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{l1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{l2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut3<>"$}{r1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut4<>"$}{r2}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];,
6,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>"Penguin"<>ToString[states]<>ToString[getBlank[prop]]<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(150,75)\n"];
WriteString[file,"\\fmfleft{l2,l1}\n"];
WriteString[file,"\\fmfright{r2,r1}\n"];
WriteString[file,"\\fmf{phantom}{r1,v1}\n"];
WriteString[file,"\\fmf{plain}{v1,r2}\n"];
WriteString[file,"\\fmf{phantom}{l1,v2}\n"];
WriteString[file,"\\fmf{"<>line3<>",label=$"<>nameIn3<>"$,tension=0.3}{v2,v3}\n"];
WriteString[file,"\\fmf{"<>line2<>",label=$"<>nameIn2<>"$,tension=0.3}{v3,v4}\n"];
WriteString[file,"\\fmf{plain}{v4,l2}\n"];
WriteString[file,"\\fmf{"<>lineProp<>",tension=1.0,label=$"<>nameProp<>"$}{v1,v3}\n"];
WriteString[file,"\\fmf{"<>line1<>",tension=0.1,label=$"<>nameIn1<>"$}{v2,v4}\n"];
WriteString[file,"\\fmffreeze \n"];
WriteString[file,"\\fmf{plain}{v1,l1}\n"];
WriteString[file,"\\fmf{plain}{v2,r1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{l1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{l2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut3<>"$}{r1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut4<>"$}{r2}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];
];
WriteString[file,"\\end{center}\n \n"];
];


DrawPenguinDiagram[t1_,t2_,t3_,p1_,p2_,p3_,ins_,nr_,states_,name_,file_]:=Block[{nameIn1,nameIn2,nameIn3,nameProp,nameOut1,nameOut2,nameOut3,nameOut4,line1,line2,line3,lineProp},

Switch[getType[p1],
S,line1="dashes";,
V,line1="wiggly";,
F,line1="plain";
];

Switch[getType[p2],
S,line2="dashes";,
V,line2="wiggly";,
F,line2="plain";
];

Switch[getType[p3],
S,line3="dashes";,
V,line3="wiggly";,
F,line3="plain";
];

Switch[getType[t3],
S,lineProp="dashes";,
V,lineProp="wiggly";,
F,lineProp="plain";
];

nameIn1=If[getGen[p1]>1,TeXOutput[p1],TeXOutput[p1 /.a_[{b_}]->a]];
nameIn2=If[getGen[p2]>1,TeXOutput[p2],TeXOutput[p2 /.a_[{b_}]->a]];
nameIn3=If[getGen[p3]>1,TeXOutput[p3],TeXOutput[p3 /.a_[{b_}]->a]];
nameProp=If[getGen[t3]>1,TeXOutput[t3],TeXOutput[t3 /.a_[{b_}]->a]];


nameOut1=If[getGen[t1]>1,TeXOutput[t1],TeXOutput[t1 /.a_[{b_}]->a]];
nameOut2=If[getGen[t2]>1,TeXOutput[t2],TeXOutput[t2 /.a_[{b_}]->a]];

WriteString[file,"\n\n \\begin{center}\n"];
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>"Penguin"<>ToString[states]<>ToString[getBlank[prop]]<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(150,75)\n"];
WriteString[file,"\\fmfleft{l1,l2}\n"];
WriteString[file,"\\fmfright{r1,r2}\n"];
WriteString[file,"\\fmf{phantom}{r1,v1}\n"];
WriteString[file,"\\fmf{phantom}{v1,r2}\n"];
WriteString[file,"\\fmf{plain}{l1,v2}\n"];
WriteString[file,"\\fmf{"<>line3<>",label=$"<>nameIn3<>"$,tension=0.3}{v2,v3}\n"];
WriteString[file,"\\fmf{"<>line2<>",label=$"<>nameIn2<>"$,tension=0.3}{v3,v4}\n"];
WriteString[file,"\\fmf{plain}{v4,l2}\n"];
WriteString[file,"\\fmf{"<>lineProp<>",tension=1.0,label=$"<>nameProp<>"$}{v1,v3}\n"];
WriteString[file,"\\fmf{"<>line1<>",tension=0.1,label=$"<>nameIn1<>"$}{v2,v4}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{l2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{l1}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];
WriteString[file,"\\end{center}\n \n"];
];

DrawWaveDiagram[t1_,t2_,t3_,t4_,p1_,p2_,pin_,prop_,ins_,nr_,states_,name_,file_]:=Block[{nameIn1,nameIn2,nameIn,nameProp,nameOut1,nameOut2,nameOut3,nameOut4,line1,line2,lineIn,lineProp},

Switch[getType[p1],
S,line1="dashes";,
V,line1="wiggly";,
F,line1="plain";
];

Switch[getType[p2],
S,line2="dashes";,
V,line2="wiggly";,
F,line2="plain";
];

Switch[getType[pin],
S,lineIn="dashes";,
V,lineIn="wiggly";,
F,lineIn="plain";
];

Switch[getType[prop],
S,lineProp="dashes";,
V,lineProp="wiggly";,
F,lineProp="plain";
];


nameIn1=If[getGen[p1]>1,TeXOutput[p1],TeXOutput[p1 /.a_[{b_}]->a]];
nameIn2=If[getGen[p2]>1,TeXOutput[p2],TeXOutput[p2 /.a_[{b_}]->a]];
nameIn=If[getGen[pin]>1,TeXOutput[pin],TeXOutput[pin /.a_[{b_}]->a]];
nameProp=If[getGen[prop]>1,TeXOutput[prop],TeXOutput[prop /.a_[{b_}]->a]];


nameOut1=If[getGen[t1]>1,TeXOutput[t1],TeXOutput[t1 /.a_[{b_}]->a]];
nameOut2=If[getGen[t2]>1,TeXOutput[t2],TeXOutput[t2 /.a_[{b_}]->a]];
nameOut3=If[getGen[t3]>1,TeXOutput[t3],TeXOutput[t3 /.a_[{b_}]->a]];
nameOut4=If[getGen[t4]>1,TeXOutput[t4],TeXOutput[t4 /.a_[{b_}]->a]];

WriteString[file,"\n\n \\begin{center}\n"];
Switch[ins,
1,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>"Wave"<>ToString[states]<>ToString[getBlank[prop]]<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(150,75)\n"];
WriteString[file,"\\fmfleft{l2,l1}\n"];
WriteString[file,"\\fmfright{r1,r2}\n"];
WriteString[file,"\\fmf{plain}{v3,l2}\n"];
WriteString[file,"\\fmf{"<>lineProp<>",label=$"<>nameProp<>"$}{v3,v4}\n"];
WriteString[file,"\\fmf{plain}{v4,r1}\n"];
WriteString[file,"\\fmf{plain}{v4,r2}\n"];
WriteString[file,"\\fmf{phantom}{l1,v3}\n"];
WriteString[file,"\\fmffreeze\n"];
WriteString[file,"\\fmf{plain}{l1,v1}\n"];
WriteString[file,"\\fmf{"<>line1<>",right,tension=0.2,label=$"<>nameIn1<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>line2<>",left,tension=0.2,label=$"<>nameIn2<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>lineIn<>",label=$"<>nameIn<>"$}{v2,v3}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{l1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{l2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut3<>"$}{r1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut4<>"$}{r2}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];,

2,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>"Wave"<>ToString[states]<>ToString[getBlank[prop]]<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(150,75)\n"];
WriteString[file,"\\fmfleft{l1,l2}\n"];
WriteString[file,"\\fmfright{r1,r2}\n"];
WriteString[file,"\\fmf{plain}{v3,l2}\n"];
WriteString[file,"\\fmf{"<>lineProp<>",label=$"<>nameProp<>"$}{v3,v4}\n"];
WriteString[file,"\\fmf{plain}{v4,r1}\n"];
WriteString[file,"\\fmf{plain}{v4,r2}\n"];
WriteString[file,"\\fmf{phantom}{l1,v3}\n"];
WriteString[file,"\\fmffreeze\n"];
WriteString[file,"\\fmf{plain}{l1,v1}\n"];
WriteString[file,"\\fmf{"<>line1<>",right,tension=0.2,label=$"<>nameIn1<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>line2<>",left,tension=0.2,label=$"<>nameIn2<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>lineIn<>",label=$"<>nameIn<>"$}{v2,v3}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{l2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{l1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut3<>"$}{r1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut4<>"$}{r2}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];,

3,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>"Wave"<>ToString[states]<>ToString[getBlank[prop]]<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(150,75)\n"];
WriteString[file,"\\fmfleft{r1,l1}\n"];
WriteString[file,"\\fmfright{r2,l2}\n"];
WriteString[file,"\\fmf{plain}{v3,l2}\n"];
WriteString[file,"\\fmf{"<>lineProp<>",label=$"<>nameProp<>"$}{v3,v4}\n"];
WriteString[file,"\\fmf{plain}{v4,r1}\n"];
WriteString[file,"\\fmf{plain}{v4,r2}\n"];
WriteString[file,"\\fmf{phantom}{l1,v3}\n"];
WriteString[file,"\\fmffreeze\n"];
WriteString[file,"\\fmf{plain}{l1,v1}\n"];
WriteString[file,"\\fmf{"<>line1<>",right,tension=0.2,label=$"<>nameIn1<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>line2<>",left,tension=0.2,label=$"<>nameIn2<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>lineIn<>",label=$"<>nameIn<>"$}{v2,v3}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{l1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{r1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut3<>"$}{l2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut4<>"$}{r2}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];,

4,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>"Wave"<>ToString[states]<>ToString[getBlank[prop]]<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(150,75)\n"];
WriteString[file,"\\fmfleft{r1,l2}\n"];
WriteString[file,"\\fmfright{r2,l1}\n"];
WriteString[file,"\\fmf{plain}{v3,l2}\n"];
WriteString[file,"\\fmf{"<>lineProp<>",label=$"<>nameProp<>"$}{v3,v4}\n"];
WriteString[file,"\\fmf{plain}{v4,r1}\n"];
WriteString[file,"\\fmf{plain}{v4,r2}\n"];
WriteString[file,"\\fmf{phantom}{l1,v3}\n"];
WriteString[file,"\\fmffreeze\n"];
WriteString[file,"\\fmf{plain}{l1,v1}\n"];
WriteString[file,"\\fmf{"<>line1<>",right,tension=0.2,label=$"<>nameIn1<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>line2<>",left,tension=0.2,label=$"<>nameIn2<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>lineIn<>",label=$"<>nameIn<>"$}{v2,v3}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{l2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{r1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut3<>"$}{l1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut4<>"$}{r2}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];,

5,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>"Wave"<>ToString[states]<>ToString[getBlank[prop]]<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(150,75)\n"];
WriteString[file,"\\fmfleft{r1,l1}\n"];
WriteString[file,"\\fmfright{r2,l2}\n"];
WriteString[file,"\\fmf{phantom}{v3,l2}\n"];
WriteString[file,"\\fmf{"<>lineProp<>",label=$"<>nameProp<>"$}{v3,v4}\n"];
WriteString[file,"\\fmf{plain}{v4,r1}\n"];
WriteString[file,"\\fmf{phantom}{v4,r2}\n"];
WriteString[file,"\\fmf{phantom}{l1,v3}\n"];
WriteString[file,"\\fmffreeze\n"];
WriteString[file,"\\fmf{plain}{l1,v1}\n"];
WriteString[file,"\\fmf{"<>line1<>",right,tension=0.2,label=$"<>nameIn1<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>line2<>",left,tension=0.2,label=$"<>nameIn2<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>lineIn<>",label=$"<>nameIn<>"$}{v2,v3}\n"];
WriteString[file,"\\fmf{plain}{v3,r2}\n"];
WriteString[file,"\\fmf{plain}{v4,l2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{l1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{r1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut3<>"$}{l2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut4<>"$}{r2}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];,
6,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>"Wave"<>ToString[states]<>ToString[getBlank[prop]]<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(150,75)\n"];
WriteString[file,"\\fmfleft{r1,r2}\n"];
WriteString[file,"\\fmfright{l1,l2}\n"];
WriteString[file,"\\fmf{phantom}{v3,l2}\n"];
WriteString[file,"\\fmf{"<>lineProp<>",label=$"<>nameProp<>"$}{v3,v4}\n"];
WriteString[file,"\\fmf{plain}{v4,r1}\n"];
WriteString[file,"\\fmf{phantom}{v4,r2}\n"];
WriteString[file,"\\fmf{phantom}{l1,v3}\n"];
WriteString[file,"\\fmffreeze\n"];
WriteString[file,"\\fmf{plain}{l1,v1}\n"];
WriteString[file,"\\fmf{"<>line1<>",right,tension=0.2,label=$"<>nameIn1<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>line2<>",left,tension=0.2,label=$"<>nameIn2<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>lineIn<>",label=$"<>nameIn<>"$}{v2,v3}\n"];
WriteString[file,"\\fmf{plain}{v3,r2}\n"];
WriteString[file,"\\fmf{plain}{v4,l2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{l2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{l1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut3<>"$}{r2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut4<>"$}{r1}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];,

7,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>"Wave"<>ToString[states]<>ToString[getBlank[prop]]<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(150,75)\n"];
WriteString[file,"\\fmfright{l2,l1}\n"];
WriteString[file,"\\fmfleft{r1,r2}\n"];
WriteString[file,"\\fmf{plain}{v3,l2}\n"];
WriteString[file,"\\fmf{"<>lineProp<>",label=$"<>nameProp<>"$}{v3,v4}\n"];
WriteString[file,"\\fmf{plain}{v4,r1}\n"];
WriteString[file,"\\fmf{plain}{v4,r2}\n"];
WriteString[file,"\\fmf{phantom}{l1,v3}\n"];
WriteString[file,"\\fmffreeze\n"];
WriteString[file,"\\fmf{plain}{l1,v1}\n"];
WriteString[file,"\\fmf{"<>line1<>",right,tension=0.2,label=$"<>nameIn1<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>line2<>",left,tension=0.2,label=$"<>nameIn2<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>lineIn<>",label=$"<>nameIn<>"$}{v2,v3}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{l1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{l2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut3<>"$}{r1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut4<>"$}{r2}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];,

8,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>"Wave"<>ToString[states]<>ToString[getBlank[prop]]<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(150,75)\n"];
WriteString[file,"\\fmfright{l1,l2}\n"];
WriteString[file,"\\fmfleft{r1,r2}\n"];
WriteString[file,"\\fmf{plain}{v3,l2}\n"];
WriteString[file,"\\fmf{"<>lineProp<>",label=$"<>nameProp<>"$}{v3,v4}\n"];
WriteString[file,"\\fmf{plain}{v4,r1}\n"];
WriteString[file,"\\fmf{plain}{v4,r2}\n"];
WriteString[file,"\\fmf{phantom}{l1,v3}\n"];
WriteString[file,"\\fmffreeze\n"];
WriteString[file,"\\fmf{plain}{l1,v1}\n"];
WriteString[file,"\\fmf{"<>line1<>",right,tension=0.2,label=$"<>nameIn1<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>line2<>",left,tension=0.2,label=$"<>nameIn2<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>lineIn<>",label=$"<>nameIn<>"$}{v2,v3}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{r2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{r1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut3<>"$}{l1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut4<>"$}{l2}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];,

9,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>"Wave"<>ToString[states]<>ToString[getBlank[prop]]<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(150,75)\n"];
WriteString[file,"\\fmfleft{l1,r1}\n"];
WriteString[file,"\\fmfright{l2,r2}\n"];
WriteString[file,"\\fmf{plain}{v3,l2}\n"];
WriteString[file,"\\fmf{"<>lineProp<>",label=$"<>nameProp<>"$}{v3,v4}\n"];
WriteString[file,"\\fmf{plain}{v4,r1}\n"];
WriteString[file,"\\fmf{plain}{v4,r2}\n"];
WriteString[file,"\\fmf{phantom}{l1,v3}\n"];
WriteString[file,"\\fmffreeze\n"];
WriteString[file,"\\fmf{plain}{l1,v1}\n"];
WriteString[file,"\\fmf{"<>line1<>",right,tension=0.2,label=$"<>nameIn1<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>line2<>",left,tension=0.2,label=$"<>nameIn2<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>lineIn<>",label=$"<>nameIn<>"$}{v2,v3}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{r1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{l1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut3<>"$}{r2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut4<>"$}{l2}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];,

10,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>"Wave"<>ToString[states]<>ToString[getBlank[prop]]<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(150,75)\n"];
WriteString[file,"\\fmfleft{l1,r2}\n"];
WriteString[file,"\\fmfright{l2,r1}\n"];
WriteString[file,"\\fmf{plain}{v3,l2}\n"];
WriteString[file,"\\fmf{"<>lineProp<>",label=$"<>nameProp<>"$}{v3,v4}\n"];
WriteString[file,"\\fmf{plain}{v4,r1}\n"];
WriteString[file,"\\fmf{plain}{v4,r2}\n"];
WriteString[file,"\\fmf{phantom}{l1,v3}\n"];
WriteString[file,"\\fmffreeze\n"];
WriteString[file,"\\fmf{plain}{l1,v1}\n"];
WriteString[file,"\\fmf{"<>line1<>",right,tension=0.2,label=$"<>nameIn1<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>line2<>",left,tension=0.2,label=$"<>nameIn2<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>lineIn<>",label=$"<>nameIn<>"$}{v2,v3}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{r2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{l1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut3<>"$}{r1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut4<>"$}{l2}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];,

11,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>"Wave"<>ToString[states]<>ToString[getBlank[prop]]<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(150,75)\n"];
WriteString[file,"\\fmfleft{l1,r1}\n"];
WriteString[file,"\\fmfright{l2,r2}\n"];
WriteString[file,"\\fmf{phantom}{v3,l2}\n"];
WriteString[file,"\\fmf{"<>lineProp<>",label=$"<>nameProp<>"$}{v3,v4}\n"];
WriteString[file,"\\fmf{plain}{v4,r1}\n"];
WriteString[file,"\\fmf{phantom}{v4,r2}\n"];
WriteString[file,"\\fmf{phantom}{l1,v3}\n"];
WriteString[file,"\\fmffreeze\n"];
WriteString[file,"\\fmf{plain}{l1,v1}\n"];
WriteString[file,"\\fmf{"<>line1<>",right,tension=0.2,label=$"<>nameIn1<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>line2<>",left,tension=0.2,label=$"<>nameIn2<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>lineIn<>",label=$"<>nameIn<>"$}{v2,v3}\n"];
WriteString[file,"\\fmf{plain}{v3,r2}\n"];
WriteString[file,"\\fmf{plain}{v4,l2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{r1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{l1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut3<>"$}{r2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut4<>"$}{l2}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];,
12,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>"Wave"<>ToString[states]<>ToString[getBlank[prop]]<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(150,75)\n"];
WriteString[file,"\\fmfleft{r2,r1}\n"];
WriteString[file,"\\fmfright{l2,l1}\n"];
WriteString[file,"\\fmf{phantom}{v3,l2}\n"];
WriteString[file,"\\fmf{"<>lineProp<>",label=$"<>nameProp<>"$}{v3,v4}\n"];
WriteString[file,"\\fmf{plain}{v4,r1}\n"];
WriteString[file,"\\fmf{phantom}{v4,r2}\n"];
WriteString[file,"\\fmf{phantom}{l1,v3}\n"];
WriteString[file,"\\fmffreeze\n"];
WriteString[file,"\\fmf{plain}{l1,v1}\n"];
WriteString[file,"\\fmf{"<>line1<>",right,tension=0.2,label=$"<>nameIn1<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>line2<>",left,tension=0.2,label=$"<>nameIn2<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>lineIn<>",label=$"<>nameIn<>"$}{v2,v3}\n"];
WriteString[file,"\\fmf{plain}{v3,r2}\n"];
WriteString[file,"\\fmf{plain}{v4,l2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{r1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{r2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut3<>"$}{l1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut4<>"$}{l2}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];
];
WriteString[file,"\\end{center}\n \n"];
];


DrawWaveDiagram[t1_,t2_,t3_,p1_,p2_,pin_,ins_,nr_,states_,name_,file_]:=Block[{nameIn1,nameIn2,nameIn,nameProp,nameOut1,nameOut2,nameOut3,nameOut4,line1,line2,lineIn,lineProp},

Switch[getType[p1],
S,line1="dashes";,
V,line1="wiggly";,
F,line1="plain";
];

Switch[getType[p2],
S,line2="dashes";,
V,line2="wiggly";,
F,line2="plain";
];

Switch[getType[pin],
S,lineIn="dashes";,
V,lineIn="wiggly";,
F,lineIn="plain";
];

Switch[getType[t3],
S,lineProp="dashes";,
V,lineProp="wiggly";,
F,lineProp="plain";
];


nameIn1=If[getGen[p1]>1,TeXOutput[p1],TeXOutput[p1 /.a_[{b_}]->a]];
nameIn2=If[getGen[p2]>1,TeXOutput[p2],TeXOutput[p2 /.a_[{b_}]->a]];
nameIn=If[getGen[pin]>1,TeXOutput[pin],TeXOutput[pin /.a_[{b_}]->a]];
nameProp=If[getGen[t3]>1,TeXOutput[t3],TeXOutput[t3 /.a_[{b_}]->a]];

nameOut1=If[getGen[t1]>1,TeXOutput[t1],TeXOutput[t1 /.a_[{b_}]->a]];
nameOut2=If[getGen[t2]>1,TeXOutput[t2],TeXOutput[t2 /.a_[{b_}]->a]];

WriteString[file,"\n\n \\begin{center}\n"];
Switch[ins,
1,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>"Wave"<>ToString[states]<>ToString[getBlank[prop]]<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(150,75)\n"];
WriteString[file,"\\fmfleft{l2,l1}\n"];
WriteString[file,"\\fmfright{r1,r2}\n"];
WriteString[file,"\\fmf{plain}{v3,l2}\n"];
WriteString[file,"\\fmf{"<>lineProp<>",label=$"<>nameProp<>"$}{v3,v4}\n"];
WriteString[file,"\\fmf{phantom}{v4,r1}\n"];
WriteString[file,"\\fmf{phantom}{v4,r2}\n"];
WriteString[file,"\\fmf{phantom}{l1,v3}\n"];
WriteString[file,"\\fmffreeze\n"];
WriteString[file,"\\fmf{plain}{l1,v1}\n"];
WriteString[file,"\\fmf{"<>line1<>",right,tension=0.2,label=$"<>nameIn1<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>line2<>",left,tension=0.2,label=$"<>nameIn2<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>lineIn<>",label=$"<>nameIn<>"$}{v2,v3}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{l1}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{l2}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];,

2,
WriteString[file,"\\begin{fmffile}{Diagrams/"<>ToString[name]<>"Wave"<>ToString[states]<>ToString[getBlank[prop]]<>ToString[nr]<>"}\n"];
WriteString[file,"\\fmfframe(20,20)(20,20){\n"];
WriteString[file,"\\begin{fmfgraph*}(150,75)\n"];
WriteString[file,"\\fmfleft{l1,l2}\n"];
WriteString[file,"\\fmfright{r1,r2}\n"];
WriteString[file,"\\fmf{plain}{v3,l2}\n"];
WriteString[file,"\\fmf{"<>lineProp<>",label=$"<>nameProp<>"$}{v3,v4}\n"];
WriteString[file,"\\fmf{phantom}{v4,r1}\n"];
WriteString[file,"\\fmf{phantom}{v4,r2}\n"];
WriteString[file,"\\fmf{phantom}{l1,v3}\n"];
WriteString[file,"\\fmffreeze\n"];
WriteString[file,"\\fmf{plain}{l1,v1}\n"];
WriteString[file,"\\fmf{"<>line1<>",right,tension=0.2,label=$"<>nameIn1<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>line2<>",left,tension=0.2,label=$"<>nameIn2<>"$}{v1,v2}\n"];
WriteString[file,"\\fmf{"<>lineIn<>",label=$"<>nameIn<>"$}{v2,v3}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut1<>"$}{l2}\n"];
WriteString[file,"\\fmflabel{$"<>nameOut2<>"$}{l1}\n"];
WriteString[file,"\\end{fmfgraph*}}\n"];
WriteString[file,"\\end{fmffile}\n"];
];
WriteString[file,"\\end{center}\n \n"];
];

