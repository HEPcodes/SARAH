! Code automatically generated by 'PreSARAH'  
! Expressions for amplitudes are obtained by FeynArts/FormCalc  
! Created at 14:09 on 7.11.2016  
 
 
Module DecayFFV 

Use Control 
Use LoopFunctions 
Use AddLoopFunctions 
Use Settings

Contains 

Subroutine TreeAmp_FtoFV(Mex1,Mex2,Mex3,coupT1L, coupT1R,Amplitude)
Implicit None 
Real(dp), Intent(in) :: Mex1,Mex2,Mex3 
Complex(dp), Intent(out) :: Amplitude(4) 
Complex(dp), Intent(in) :: coupT1L, coupT1R 

Amplitude = 0._dp

! Now the full amplitude for the different Lorentz Parts 
! Coefficient of Mat[<v1|6,ec[3]|v2>] 
Amplitude(1)= 1*(0.,1._dp)*coupT1R 


! Coefficient of Mat[<v1|7,ec[3]|v2>] 
Amplitude(2)= 1*(0.,1._dp)*coupT1L 


End Subroutine TreeAmp_FtoFV

! -------------------------------------- 
! Topology Nr.1
! -------------------------------------- 

Subroutine Amp_VERTEX_FtoFV_Topology1_SFF(Mex1,Mex2,Mex3,ML1, ML2, ML3,coup1L, coup1R, coup2L, coup2R, coup3L, coup3R,Amplitude)
Implicit None 
Real(dp), Intent(in) :: Mex1,Mex2,Mex3 
Complex(dp), Intent(out) :: Amplitude(4) 
Real(dp), Intent(in) :: ML1, ML2, ML3 
Complex(dp), Intent(in) :: coup1L, coup1R, coup2L, coup2R, coup3L, coup3R 
Complex(dp) :: int1,int2,int3,int4,int5,int6,int7,int8,int9,int10 

Amplitude = 0._dp

! Necessary Loop Integrals 
int1=SA_B0(Mex3**2,ML2**2,ML3**2)
int2=SA_Cget("C0  ",Mex3**2,Mex2**2,Mex1**2,ML2**2,ML3**2,ML1**2)
int3=SA_Cget("C00 ",Mex3**2,Mex2**2,Mex1**2,ML2**2,ML3**2,ML1**2)
int4=SA_Cget("C1  ",Mex3**2,Mex2**2,Mex1**2,ML2**2,ML3**2,ML1**2)
int5=SA_Cget("C12 ",Mex3**2,Mex2**2,Mex1**2,ML2**2,ML3**2,ML1**2)
int6=SA_Cget("C2  ",Mex3**2,Mex2**2,Mex1**2,ML2**2,ML3**2,ML1**2)
int7=SA_Cget("C22 ",Mex3**2,Mex2**2,Mex1**2,ML2**2,ML3**2,ML1**2)


! Now the full amplitude for the different Lorentz Parts 
! Coefficient of Mat[<v1|6,ec[3]|v2>] 
Amplitude(1)= & 
& +(-1*(0.,1._dp)*coup1R*coup2L*coup3R*int1) & 
& +(2*(0.,1._dp)*coup1R*coup2L*coup3R*int3) & 
& +(1*(0.,1._dp)*coup1R*coup2L*coup3R*int2*Mex1**2) & 
& +(1*(0.,1._dp)*coup1R*coup2L*coup3R*int4*Mex1**2) & 
& +(1*(0.,1._dp)*coup1R*coup2L*coup3R*int6*Mex1**2) & 
& +(-1*(0.,1._dp)*coup1L*coup2R*coup3L*int6*Mex1*Mex2) & 
& +(-1*(0.,1._dp)*coup1R*coup2L*coup3R*int4*Mex2**2) & 
& +(-1*(0.,1._dp)*coup1R*coup2L*coup3R*int2*ML1**2) & 
& +(1*(0.,1._dp)*coup1L*coup2L*coup3R*int2*Mex1*ML2) & 
& +(1*(0.,1._dp)*coup1L*coup2L*coup3R*int4*Mex1*ML2) & 
& +(1*(0.,1._dp)*coup1L*coup2L*coup3R*int6*Mex1*ML2) & 
& +(1*(0.,1._dp)*coup1R*coup2R*coup3L*int2*Mex2*ML2) & 
& +(1*(0.,1._dp)*coup1R*coup2R*coup3L*int4*Mex2*ML2) & 
& +(-1*(0.,1._dp)*coup1L*coup2L*coup3L*int4*Mex1*ML3) & 
& +(-1*(0.,1._dp)*coup1L*coup2L*coup3L*int6*Mex1*ML3) & 
& +(-1*(0.,1._dp)*coup1R*coup2R*coup3R*int4*Mex2*ML3) & 
& +(1*(0.,1._dp)*coup1R*coup2L*coup3L*int2*ML2*ML3)



! Coefficient of Mat[<v1|7,ec[3]|v2>] 
Amplitude(2)= & 
& +(-1*(0.,1._dp)*coup1L*coup2R*coup3L*int1) & 
& +(2*(0.,1._dp)*coup1L*coup2R*coup3L*int3) & 
& +(1*(0.,1._dp)*coup1L*coup2R*coup3L*int2*Mex1**2) & 
& +(1*(0.,1._dp)*coup1L*coup2R*coup3L*int4*Mex1**2) & 
& +(1*(0.,1._dp)*coup1L*coup2R*coup3L*int6*Mex1**2) & 
& +(-1*(0.,1._dp)*coup1R*coup2L*coup3R*int6*Mex1*Mex2) & 
& +(-1*(0.,1._dp)*coup1L*coup2R*coup3L*int4*Mex2**2) & 
& +(-1*(0.,1._dp)*coup1L*coup2R*coup3L*int2*ML1**2) & 
& +(1*(0.,1._dp)*coup1R*coup2R*coup3L*int2*Mex1*ML2) & 
& +(1*(0.,1._dp)*coup1R*coup2R*coup3L*int4*Mex1*ML2) & 
& +(1*(0.,1._dp)*coup1R*coup2R*coup3L*int6*Mex1*ML2) & 
& +(1*(0.,1._dp)*coup1L*coup2L*coup3R*int2*Mex2*ML2) & 
& +(1*(0.,1._dp)*coup1L*coup2L*coup3R*int4*Mex2*ML2) & 
& +(-1*(0.,1._dp)*coup1R*coup2R*coup3R*int4*Mex1*ML3) & 
& +(-1*(0.,1._dp)*coup1R*coup2R*coup3R*int6*Mex1*ML3) & 
& +(-1*(0.,1._dp)*coup1L*coup2L*coup3L*int4*Mex2*ML3) & 
& +(1*(0.,1._dp)*coup1L*coup2R*coup3R*int2*ML2*ML3)



! Coefficient of Mat[<v1|6|v2>] Pair[ec[3], k[1]] 
Amplitude(3)= & 
& +(-2*(0.,1._dp)*coup1L*coup2R*coup3L*int5*Mex1) & 
& +(-2*(0.,1._dp)*coup1L*coup2R*coup3L*int6*Mex1) & 
& +(-2*(0.,1._dp)*coup1L*coup2R*coup3L*int7*Mex1) & 
& +(2*(0.,1._dp)*coup1R*coup2L*coup3R*int5*Mex2) & 
& +(2*(0.,1._dp)*coup1R*coup2R*coup3L*int2*ML2) & 
& +(2*(0.,1._dp)*coup1R*coup2R*coup3L*int4*ML2) & 
& +(2*(0.,1._dp)*coup1R*coup2R*coup3L*int6*ML2) & 
& +(-2*(0.,1._dp)*coup1R*coup2R*coup3R*int4*ML3)



! Coefficient of Mat[<v1|7|v2>] Pair[ec[3], k[1]] 
Amplitude(4)= & 
& +(-2*(0.,1._dp)*coup1R*coup2L*coup3R*int5*Mex1) & 
& +(-2*(0.,1._dp)*coup1R*coup2L*coup3R*int6*Mex1) & 
& +(-2*(0.,1._dp)*coup1R*coup2L*coup3R*int7*Mex1) & 
& +(2*(0.,1._dp)*coup1L*coup2R*coup3L*int5*Mex2) & 
& +(2*(0.,1._dp)*coup1L*coup2L*coup3R*int2*ML2) & 
& +(2*(0.,1._dp)*coup1L*coup2L*coup3R*int4*ML2) & 
& +(2*(0.,1._dp)*coup1L*coup2L*coup3R*int6*ML2) & 
& +(-2*(0.,1._dp)*coup1L*coup2L*coup3L*int4*ML3)

If ((Abs(Amplitude(1))).ne.(Abs(Amplitude(1)))) Then
Amplitude=0._dp
End if

!Field Order 
! FieldOrder[1,{S, F, F},1]={External[1][gt1], AntiField[Internal[2]][i2], Internal[1][i1]}; 
! FieldOrder[1,{S, F, F},2]={Internal[3][i3], External[2][gt2], AntiField[Internal[1]][i1]}; 
! FieldOrder[1,{S, F, F},3]={Internal[2][i2], AntiField[Internal[3]][i3], External[3][gt3]}; 
End Subroutine Amp_VERTEX_FtoFV_Topology1_SFF

Subroutine Amp_VERTEX_FtoFV_Topology1_FSS(Mex1,Mex2,Mex3,ML1, ML2, ML3,coup1L, coup1R, coup2L, coup2R, coup3,Amplitude)
Implicit None 
Real(dp), Intent(in) :: Mex1,Mex2,Mex3 
Complex(dp), Intent(out) :: Amplitude(4) 
Real(dp), Intent(in) :: ML1, ML2, ML3 
Complex(dp), Intent(in) :: coup1L, coup1R, coup2L, coup2R, coup3 
Complex(dp) :: int1,int2,int3,int4,int5,int6,int7,int8,int9,int10 

Amplitude = 0._dp

! Necessary Loop Integrals 
int1=SA_Cget("C0  ",Mex2**2,Mex3**2,Mex1**2,ML1**2,ML3**2,ML2**2)
int2=SA_Cget("C00 ",Mex2**2,Mex3**2,Mex1**2,ML1**2,ML3**2,ML2**2)
int3=SA_Cget("C1  ",Mex2**2,Mex3**2,Mex1**2,ML1**2,ML3**2,ML2**2)
int4=SA_Cget("C11 ",Mex2**2,Mex3**2,Mex1**2,ML1**2,ML3**2,ML2**2)
int5=SA_Cget("C12 ",Mex2**2,Mex3**2,Mex1**2,ML1**2,ML3**2,ML2**2)
int6=SA_Cget("C2  ",Mex2**2,Mex3**2,Mex1**2,ML1**2,ML3**2,ML2**2)
int7=SA_Cget("C22 ",Mex2**2,Mex3**2,Mex1**2,ML1**2,ML3**2,ML2**2)


! Now the full amplitude for the different Lorentz Parts 
! Coefficient of Mat[<v1|6,ec[3]|v2>] 
Amplitude(1)= 2*(0.,1._dp)*coup1R*coup2L*coup3*int2 


! Coefficient of Mat[<v1|7,ec[3]|v2>] 
Amplitude(2)= 2*(0.,1._dp)*coup1L*coup2R*coup3*int2 


! Coefficient of Mat[<v1|6|v2>] Pair[ec[3], k[1]] 
Amplitude(3)= & 
& +(-2*(0.,1._dp)*coup1L*coup2R*coup3*int5*Mex1) & 
& +(-2*(0.,1._dp)*coup1L*coup2R*coup3*int6*Mex1) & 
& +(-2*(0.,1._dp)*coup1L*coup2R*coup3*int7*Mex1) & 
& +(-2*(0.,1._dp)*coup1R*coup2L*coup3*int3*Mex2) & 
& +(-2*(0.,1._dp)*coup1R*coup2L*coup3*int4*Mex2) & 
& +(-2*(0.,1._dp)*coup1R*coup2L*coup3*int5*Mex2) & 
& +(2*(0.,1._dp)*coup1R*coup2R*coup3*int1*ML1) & 
& +(2*(0.,1._dp)*coup1R*coup2R*coup3*int3*ML1) & 
& +(2*(0.,1._dp)*coup1R*coup2R*coup3*int6*ML1)



! Coefficient of Mat[<v1|7|v2>] Pair[ec[3], k[1]] 
Amplitude(4)= & 
& +(-2*(0.,1._dp)*coup1R*coup2L*coup3*int5*Mex1) & 
& +(-2*(0.,1._dp)*coup1R*coup2L*coup3*int6*Mex1) & 
& +(-2*(0.,1._dp)*coup1R*coup2L*coup3*int7*Mex1) & 
& +(-2*(0.,1._dp)*coup1L*coup2R*coup3*int3*Mex2) & 
& +(-2*(0.,1._dp)*coup1L*coup2R*coup3*int4*Mex2) & 
& +(-2*(0.,1._dp)*coup1L*coup2R*coup3*int5*Mex2) & 
& +(2*(0.,1._dp)*coup1L*coup2L*coup3*int1*ML1) & 
& +(2*(0.,1._dp)*coup1L*coup2L*coup3*int3*ML1) & 
& +(2*(0.,1._dp)*coup1L*coup2L*coup3*int6*ML1)

If ((Abs(Amplitude(1))).ne.(Abs(Amplitude(1)))) Then
Amplitude=0._dp
End if

!Field Order 
! FieldOrder[1,{F, S, S},1]={External[1][gt1], Internal[1][i1], AntiField[Internal[2]][i2]}; 
! FieldOrder[1,{F, S, S},2]={AntiField[Internal[1]][i1], External[2][gt2], Internal[3][i3]}; 
! FieldOrder[1,{F, S, S},3]={Internal[2][i2], AntiField[Internal[3]][i3], External[3][gt3]}; 
End Subroutine Amp_VERTEX_FtoFV_Topology1_FSS

Subroutine Amp_VERTEX_FtoFV_Topology1_VFF(Mex1,Mex2,Mex3,ML1, ML2, ML3,coup1L, coup1R, coup2L, coup2R, coup3L, coup3R,Amplitude)
Implicit None 
Real(dp), Intent(in) :: Mex1,Mex2,Mex3 
Complex(dp), Intent(out) :: Amplitude(4) 
Real(dp), Intent(in) :: ML1, ML2, ML3 
Complex(dp), Intent(in) :: coup1L, coup1R, coup2L, coup2R, coup3L, coup3R 
Complex(dp) :: int1,int2,int3,int4,int5,int6,int7,int8,int9,int10 

Amplitude = 0._dp

! Necessary Loop Integrals 
int1=SA_B0(Mex3**2,ML2**2,ML3**2)
int2=SA_Cget("C0  ",Mex3**2,Mex2**2,Mex1**2,ML2**2,ML3**2,ML1**2)
int3=SA_Cget("C00 ",Mex3**2,Mex2**2,Mex1**2,ML2**2,ML3**2,ML1**2)
int4=SA_Cget("C1  ",Mex3**2,Mex2**2,Mex1**2,ML2**2,ML3**2,ML1**2)
int5=SA_Cget("C12 ",Mex3**2,Mex2**2,Mex1**2,ML2**2,ML3**2,ML1**2)
int6=SA_Cget("C2  ",Mex3**2,Mex2**2,Mex1**2,ML2**2,ML3**2,ML1**2)
int7=SA_Cget("C22 ",Mex3**2,Mex2**2,Mex1**2,ML2**2,ML3**2,ML1**2)


! Now the full amplitude for the different Lorentz Parts 
! Coefficient of Mat[<v1|6,ec[3]|v2>] 
Amplitude(1)= & 
& +(1*(0.,1._dp)*coup1L*coup2L*coup3L*rMS) & 
& +(-2*(0.,1._dp)*coup1L*coup2L*coup3L*int1) & 
& +(4*(0.,1._dp)*coup1L*coup2L*coup3L*int3) & 
& +(2*(0.,1._dp)*coup1L*coup2L*coup3L*int2*Mex1**2) & 
& +(2*(0.,1._dp)*coup1L*coup2L*coup3L*int4*Mex1**2) & 
& +(4*(0.,1._dp)*coup1L*coup2L*coup3L*int6*Mex1**2) & 
& +(2*(0.,1._dp)*coup1R*coup2R*coup3R*int6*Mex1*Mex2) & 
& +(-2*(0.,1._dp)*coup1L*coup2L*coup3L*int4*Mex2**2) & 
& +(2*(0.,1._dp)*coup1L*coup2L*coup3L*int6*Mex2**2) & 
& +(-2*(0.,1._dp)*coup1L*coup2L*coup3L*int6*Mex3**2) & 
& +(-2*(0.,1._dp)*coup1L*coup2L*coup3L*int2*ML1**2) & 
& +(2*(0.,1._dp)*coup1L*coup2L*coup3R*int2*ML2*ML3)



! Coefficient of Mat[<v1|7,ec[3]|v2>] 
Amplitude(2)= & 
& +(1*(0.,1._dp)*coup1R*coup2R*coup3R*rMS) & 
& +(-2*(0.,1._dp)*coup1R*coup2R*coup3R*int1) & 
& +(4*(0.,1._dp)*coup1R*coup2R*coup3R*int3) & 
& +(2*(0.,1._dp)*coup1R*coup2R*coup3R*int2*Mex1**2) & 
& +(2*(0.,1._dp)*coup1R*coup2R*coup3R*int4*Mex1**2) & 
& +(4*(0.,1._dp)*coup1R*coup2R*coup3R*int6*Mex1**2) & 
& +(2*(0.,1._dp)*coup1L*coup2L*coup3L*int6*Mex1*Mex2) & 
& +(-2*(0.,1._dp)*coup1R*coup2R*coup3R*int4*Mex2**2) & 
& +(2*(0.,1._dp)*coup1R*coup2R*coup3R*int6*Mex2**2) & 
& +(-2*(0.,1._dp)*coup1R*coup2R*coup3R*int6*Mex3**2) & 
& +(-2*(0.,1._dp)*coup1R*coup2R*coup3R*int2*ML1**2) & 
& +(2*(0.,1._dp)*coup1R*coup2R*coup3L*int2*ML2*ML3)



! Coefficient of Mat[<v1|6|v2>] Pair[ec[3], k[1]] 
Amplitude(3)= & 
& +(-4*(0.,1._dp)*coup1R*coup2R*coup3R*int5*Mex1) & 
& +(-4*(0.,1._dp)*coup1R*coup2R*coup3R*int7*Mex1) & 
& +(4*(0.,1._dp)*coup1L*coup2L*coup3L*int5*Mex2) & 
& +(4*(0.,1._dp)*coup1L*coup2L*coup3L*int6*Mex2) & 
& +(-4*(0.,1._dp)*coup1L*coup2R*coup3R*int6*ML2) & 
& +(-4*(0.,1._dp)*coup1L*coup2R*coup3L*int6*ML3)



! Coefficient of Mat[<v1|7|v2>] Pair[ec[3], k[1]] 
Amplitude(4)= & 
& +(-4*(0.,1._dp)*coup1L*coup2L*coup3L*int5*Mex1) & 
& +(-4*(0.,1._dp)*coup1L*coup2L*coup3L*int7*Mex1) & 
& +(4*(0.,1._dp)*coup1R*coup2R*coup3R*int5*Mex2) & 
& +(4*(0.,1._dp)*coup1R*coup2R*coup3R*int6*Mex2) & 
& +(-4*(0.,1._dp)*coup1R*coup2L*coup3L*int6*ML2) & 
& +(-4*(0.,1._dp)*coup1R*coup2L*coup3R*int6*ML3)

If ((Abs(Amplitude(1))).ne.(Abs(Amplitude(1)))) Then
Amplitude=0._dp
End if

!Field Order 
! FieldOrder[1,{V, F, F},1]={External[1][gt1], AntiField[Internal[2]][i2], Internal[1][i1]}; 
! FieldOrder[1,{V, F, F},2]={Internal[3][i3], External[2][gt2], AntiField[Internal[1]][i1]}; 
! FieldOrder[1,{V, F, F},3]={Internal[2][i2], AntiField[Internal[3]][i3], External[3][gt3]}; 
End Subroutine Amp_VERTEX_FtoFV_Topology1_VFF

Subroutine Amp_VERTEX_FtoFV_Topology1_FSV(Mex1,Mex2,Mex3,ML1, ML2, ML3,coup1L, coup1R, coup2L, coup2R, coup3,Amplitude)
Implicit None 
Real(dp), Intent(in) :: Mex1,Mex2,Mex3 
Complex(dp), Intent(out) :: Amplitude(4) 
Real(dp), Intent(in) :: ML1, ML2, ML3 
Complex(dp), Intent(in) :: coup1L, coup1R, coup2L, coup2R, coup3 
Complex(dp) :: int1,int2,int3,int4,int5,int6,int7,int8,int9,int10 

Amplitude = 0._dp

! Necessary Loop Integrals 
int1=SA_Cget("C0  ",Mex2**2,Mex3**2,Mex1**2,ML1**2,ML3**2,ML2**2)
int2=SA_Cget("C1  ",Mex2**2,Mex3**2,Mex1**2,ML1**2,ML3**2,ML2**2)
int3=SA_Cget("C2  ",Mex2**2,Mex3**2,Mex1**2,ML1**2,ML3**2,ML2**2)


! Now the full amplitude for the different Lorentz Parts 
! Coefficient of Mat[<v1|6,ec[3]|v2>] 
Amplitude(1)= & 
& +(1*(0.,1._dp)*coup1L*coup2L*coup3*int3*Mex1) & 
& +(-1*(0.,1._dp)*coup1R*coup2R*coup3*int2*Mex2) & 
& +(-1*(0.,1._dp)*coup1R*coup2L*coup3*int1*ML1)



! Coefficient of Mat[<v1|7,ec[3]|v2>] 
Amplitude(2)= & 
& +(1*(0.,1._dp)*coup1R*coup2R*coup3*int3*Mex1) & 
& +(-1*(0.,1._dp)*coup1L*coup2L*coup3*int2*Mex2) & 
& +(-1*(0.,1._dp)*coup1L*coup2R*coup3*int1*ML1)



! Coefficient of Mat[<v1|6|v2>] Pair[ec[3], k[1]] 
Amplitude(3)= -2*(0.,1._dp)*coup1R*coup2R*coup3*int2 


! Coefficient of Mat[<v1|7|v2>] Pair[ec[3], k[1]] 
Amplitude(4)= -2*(0.,1._dp)*coup1L*coup2L*coup3*int2 

If ((Abs(Amplitude(1))).ne.(Abs(Amplitude(1)))) Then
Amplitude=0._dp
End if
!Field Order 
! FieldOrder[1,{F, S, V},1]={External[1][gt1], Internal[1][i1], AntiField[Internal[2]][i2]}; 
! FieldOrder[1,{F, S, V},2]={AntiField[Internal[1]][i1], External[2][gt2], Internal[3][i3]}; 
! FieldOrder[1,{F, S, V},3]={Internal[2][i2], External[3][gt3], AntiField[Internal[3]][i3]}; 
End Subroutine Amp_VERTEX_FtoFV_Topology1_FSV

Subroutine Amp_VERTEX_FtoFV_Topology1_FVS(Mex1,Mex2,Mex3,ML1, ML2, ML3,coup1L, coup1R, coup2L, coup2R, coup3,Amplitude)
Implicit None 
Real(dp), Intent(in) :: Mex1,Mex2,Mex3 
Complex(dp), Intent(out) :: Amplitude(4) 
Real(dp), Intent(in) :: ML1, ML2, ML3 
Complex(dp), Intent(in) :: coup1L, coup1R, coup2L, coup2R, coup3 
Complex(dp) :: int1,int2,int3,int4,int5,int6,int7,int8,int9,int10 

Amplitude = 0._dp

! Necessary Loop Integrals 
int1=SA_Cget("C0  ",Mex2**2,Mex3**2,Mex1**2,ML1**2,ML3**2,ML2**2)
int2=SA_Cget("C1  ",Mex2**2,Mex3**2,Mex1**2,ML1**2,ML3**2,ML2**2)
int3=SA_Cget("C2  ",Mex2**2,Mex3**2,Mex1**2,ML1**2,ML3**2,ML2**2)


! Now the full amplitude for the different Lorentz Parts 
! Coefficient of Mat[<v1|6,ec[3]|v2>] 
Amplitude(1)= & 
& +(-1*(0.,1._dp)*coup1R*coup2L*coup3*int3*Mex1) & 
& +(1*(0.,1._dp)*coup1L*coup2R*coup3*int2*Mex2) & 
& +(-1*(0.,1._dp)*coup1L*coup2L*coup3*int1*ML1)



! Coefficient of Mat[<v1|7,ec[3]|v2>] 
Amplitude(2)= & 
& +(-1*(0.,1._dp)*coup1L*coup2R*coup3*int3*Mex1) & 
& +(1*(0.,1._dp)*coup1R*coup2L*coup3*int2*Mex2) & 
& +(-1*(0.,1._dp)*coup1R*coup2R*coup3*int1*ML1)



! Coefficient of Mat[<v1|6|v2>] Pair[ec[3], k[1]] 
Amplitude(3)= -2*(0.,1._dp)*coup1L*coup2R*coup3*int3 


! Coefficient of Mat[<v1|7|v2>] Pair[ec[3], k[1]] 
Amplitude(4)= -2*(0.,1._dp)*coup1R*coup2L*coup3*int3 

If ((Abs(Amplitude(1))).ne.(Abs(Amplitude(1)))) Then
Amplitude=0._dp
End if
!Field Order 
! FieldOrder[1,{F, V, S},1]={External[1][gt1], Internal[1][i1], AntiField[Internal[2]][i2]}; 
! FieldOrder[1,{F, V, S},2]={AntiField[Internal[1]][i1], External[2][gt2], Internal[3][i3]}; 
! FieldOrder[1,{F, V, S},3]={AntiField[Internal[3]][i3], External[3][gt3], Internal[2][i2]}; 
End Subroutine Amp_VERTEX_FtoFV_Topology1_FVS

Subroutine Amp_VERTEX_FtoFV_Topology1_FVV(Mex1,Mex2,Mex3,ML1, ML2, ML3,coup1L, coup1R, coup2L, coup2R, coup3,Amplitude)
Implicit None 
Real(dp), Intent(in) :: Mex1,Mex2,Mex3 
Complex(dp), Intent(out) :: Amplitude(4) 
Real(dp), Intent(in) :: ML1, ML2, ML3 
Complex(dp), Intent(in) :: coup1L, coup1R, coup2L, coup2R, coup3 
Complex(dp) :: int1,int2,int3,int4,int5,int6,int7,int8,int9,int10 

Amplitude = 0._dp

! Necessary Loop Integrals 
int1=SA_B0(Mex3**2,ML2**2,ML3**2)
int2=SA_Cget("C0  ",Mex2**2,Mex3**2,Mex1**2,ML1**2,ML3**2,ML2**2)
int3=SA_Cget("C00 ",Mex2**2,Mex3**2,Mex1**2,ML1**2,ML3**2,ML2**2)
int4=SA_Cget("C1  ",Mex2**2,Mex3**2,Mex1**2,ML1**2,ML3**2,ML2**2)
int5=SA_Cget("C11 ",Mex2**2,Mex3**2,Mex1**2,ML1**2,ML3**2,ML2**2)
int6=SA_Cget("C12 ",Mex2**2,Mex3**2,Mex1**2,ML1**2,ML3**2,ML2**2)
int7=SA_Cget("C2  ",Mex2**2,Mex3**2,Mex1**2,ML1**2,ML3**2,ML2**2)
int8=SA_Cget("C22 ",Mex2**2,Mex3**2,Mex1**2,ML1**2,ML3**2,ML2**2)



! Now the full amplitude for the different Lorentz Parts 
! Coefficient of Mat[<v1|6,ec[3]|v2>] 
Amplitude(1)= & 
& +(-1*(0.,1._dp)*coup1L*coup2L*coup3*rMS) & 
& +(2*(0.,1._dp)*coup1L*coup2L*coup3*int1) & 
& +(4*(0.,1._dp)*coup1L*coup2L*coup3*int3) & 
& +(2*(0.,1._dp)*coup1L*coup2L*coup3*int4*Mex1**2) & 
& +(3*(0.,1._dp)*coup1L*coup2L*coup3*int7*Mex1**2) & 
& +(3*(0.,1._dp)*coup1R*coup2R*coup3*int4*Mex1*Mex2) & 
& +(3*(0.,1._dp)*coup1R*coup2R*coup3*int7*Mex1*Mex2) & 
& +(3*(0.,1._dp)*coup1L*coup2L*coup3*int4*Mex2**2) & 
& +(2*(0.,1._dp)*coup1L*coup2L*coup3*int7*Mex2**2) & 
& +(-2*(0.,1._dp)*coup1L*coup2L*coup3*int4*Mex3**2) & 
& +(-2*(0.,1._dp)*coup1L*coup2L*coup3*int7*Mex3**2) & 
& +(3*(0.,1._dp)*coup1R*coup2L*coup3*int2*Mex1*ML1) & 
& +(3*(0.,1._dp)*coup1L*coup2R*coup3*int2*Mex2*ML1) & 
& +(2*(0.,1._dp)*coup1L*coup2L*coup3*int2*ML1**2)



! Coefficient of Mat[<v1|7,ec[3]|v2>] 
Amplitude(2)= & 
& +(-1*(0.,1._dp)*coup1R*coup2R*coup3*rMS) & 
& +(2*(0.,1._dp)*coup1R*coup2R*coup3*int1) & 
& +(4*(0.,1._dp)*coup1R*coup2R*coup3*int3) & 
& +(2*(0.,1._dp)*coup1R*coup2R*coup3*int4*Mex1**2) & 
& +(3*(0.,1._dp)*coup1R*coup2R*coup3*int7*Mex1**2) & 
& +(3*(0.,1._dp)*coup1L*coup2L*coup3*int4*Mex1*Mex2) & 
& +(3*(0.,1._dp)*coup1L*coup2L*coup3*int7*Mex1*Mex2) & 
& +(3*(0.,1._dp)*coup1R*coup2R*coup3*int4*Mex2**2) & 
& +(2*(0.,1._dp)*coup1R*coup2R*coup3*int7*Mex2**2) & 
& +(-2*(0.,1._dp)*coup1R*coup2R*coup3*int4*Mex3**2) & 
& +(-2*(0.,1._dp)*coup1R*coup2R*coup3*int7*Mex3**2) & 
& +(3*(0.,1._dp)*coup1L*coup2R*coup3*int2*Mex1*ML1) & 
& +(3*(0.,1._dp)*coup1R*coup2L*coup3*int2*Mex2*ML1) & 
& +(2*(0.,1._dp)*coup1R*coup2R*coup3*int2*ML1**2)



! Coefficient of Mat[<v1|6|v2>] Pair[ec[3], k[1]] 
Amplitude(3)= & 
& +(2*(0.,1._dp)*coup1R*coup2R*coup3*int4*Mex1) & 
& +(-4*(0.,1._dp)*coup1R*coup2R*coup3*int6*Mex1) & 
& +(-4*(0.,1._dp)*coup1R*coup2R*coup3*int8*Mex1) & 
& +(-4*(0.,1._dp)*coup1L*coup2L*coup3*int5*Mex2) & 
& +(-4*(0.,1._dp)*coup1L*coup2L*coup3*int6*Mex2) & 
& +(2*(0.,1._dp)*coup1L*coup2L*coup3*int7*Mex2) & 
& +(-6*(0.,1._dp)*coup1L*coup2R*coup3*int4*ML1) & 
& +(-6*(0.,1._dp)*coup1L*coup2R*coup3*int7*ML1)



! Coefficient of Mat[<v1|7|v2>] Pair[ec[3], k[1]] 
Amplitude(4)= & 
& +(2*(0.,1._dp)*coup1L*coup2L*coup3*int4*Mex1) & 
& +(-4*(0.,1._dp)*coup1L*coup2L*coup3*int6*Mex1) & 
& +(-4*(0.,1._dp)*coup1L*coup2L*coup3*int8*Mex1) & 
& +(-4*(0.,1._dp)*coup1R*coup2R*coup3*int5*Mex2) & 
& +(-4*(0.,1._dp)*coup1R*coup2R*coup3*int6*Mex2) & 
& +(2*(0.,1._dp)*coup1R*coup2R*coup3*int7*Mex2) & 
& +(-6*(0.,1._dp)*coup1R*coup2L*coup3*int4*ML1) & 
& +(-6*(0.,1._dp)*coup1R*coup2L*coup3*int7*ML1)


If ((Abs(Amplitude(1))).ne.(Abs(Amplitude(1)))) Then
Amplitude=0._dp
End if
!Field Order 
! FieldOrder[1,{F, V, V},1]={External[1][gt1], Internal[1][i1], AntiField[Internal[2]][i2]}; 
! FieldOrder[1,{F, V, V},2]={AntiField[Internal[1]][i1], External[2][gt2], Internal[3][i3]}; 
! FieldOrder[1,{F, V, V},3]={External[3][gt3], Internal[2][i2], AntiField[Internal[3]][i3]}; 
End Subroutine Amp_VERTEX_FtoFV_Topology1_FVV

Subroutine SquareAmp_FtoFV(Mex1,Mex2,Mex3,Amplitude,AmplitudeC,AmpSquared)
Implicit None 
Real(dp), Intent(in) :: Mex1,Mex2,Mex3 
Complex(dp), Intent(in) :: Amplitude(4), AmplitudeC(4) 
Real(dp), Intent(out) :: AmpSquared 
Real(dp) :: LorentzFactor, et
 
AmpSquared = 0._dp 

If (Mex3.gt.1._dp) Then

! Mat[<v1|6,ec[3]|v2>] x Mat[<v1|6,ec[3]|v2>]
LorentzFactor = (Mex1**4 + Mex2**4 + Mex2**2*Mex3**2 - 2*Mex3**4 + Mex1**2*(-2*Mex2**2 + Mex3**2))/(4._dp*Mex3**2) 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(1)*Conjg(AmplitudeC(1)) 

! Mat[<v1|6,ec[3]|v2>] x Mat[<v1|7,ec[3]|v2>]
LorentzFactor = (-3*Mex1*Mex2)/2._dp 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(1)*Conjg(AmplitudeC(2)) 

! Mat[<v1|6,ec[3]|v2>] x Mat[<v1|6|v2>] Pair[ec[3], k[1]]
LorentzFactor = -(Mex2*(Mex1**4 + (Mex2**2 - Mex3**2)**2 - 2*Mex1**2*(Mex2**2 + Mex3**2)))/(8._dp*Mex3**2) 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(1)*Conjg(AmplitudeC(3)) 

! Mat[<v1|6,ec[3]|v2>] x Mat[<v1|7|v2>] Pair[ec[3], k[1]]
LorentzFactor = -(Mex1*(Mex1**4 + (Mex2**2 - Mex3**2)**2 - 2*Mex1**2*(Mex2**2 + Mex3**2)))/(8._dp*Mex3**2) 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(1)*Conjg(AmplitudeC(4)) 

! Mat[<v1|7,ec[3]|v2>] x Mat[<v1|6,ec[3]|v2>]
LorentzFactor = (-3*Mex1*Mex2)/2._dp 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(2)*Conjg(AmplitudeC(1)) 

! Mat[<v1|7,ec[3]|v2>] x Mat[<v1|7,ec[3]|v2>]
LorentzFactor = (Mex1**4 + Mex2**4 + Mex2**2*Mex3**2 - 2*Mex3**4 + Mex1**2*(-2*Mex2**2 + Mex3**2))/(4._dp*Mex3**2) 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(2)*Conjg(AmplitudeC(2)) 

! Mat[<v1|7,ec[3]|v2>] x Mat[<v1|6|v2>] Pair[ec[3], k[1]]
LorentzFactor = -(Mex1*(Mex1**4 + (Mex2**2 - Mex3**2)**2 - 2*Mex1**2*(Mex2**2 + Mex3**2)))/(8._dp*Mex3**2) 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(2)*Conjg(AmplitudeC(3)) 

! Mat[<v1|7,ec[3]|v2>] x Mat[<v1|7|v2>] Pair[ec[3], k[1]]
LorentzFactor = -(Mex2*(Mex1**4 + (Mex2**2 - Mex3**2)**2 - 2*Mex1**2*(Mex2**2 + Mex3**2)))/(8._dp*Mex3**2) 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(2)*Conjg(AmplitudeC(4)) 

! Mat[<v1|6|v2>] Pair[ec[3], k[1]] x Mat[<v1|6,ec[3]|v2>]
LorentzFactor = -(Mex2*(Mex1**4 + (Mex2**2 - Mex3**2)**2 - 2*Mex1**2*(Mex2**2 + Mex3**2)))/(8._dp*Mex3**2) 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(3)*Conjg(AmplitudeC(1)) 

! Mat[<v1|6|v2>] Pair[ec[3], k[1]] x Mat[<v1|7,ec[3]|v2>]
LorentzFactor = -(Mex1*(Mex1**4 + (Mex2**2 - Mex3**2)**2 - 2*Mex1**2*(Mex2**2 + Mex3**2)))/(8._dp*Mex3**2) 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(3)*Conjg(AmplitudeC(2)) 

! Mat[<v1|6|v2>] Pair[ec[3], k[1]] x Mat[<v1|6|v2>] Pair[ec[3], k[1]]
LorentzFactor = ((Mex1**2 + Mex2**2 - Mex3**2)*(Mex1**4 + (Mex2**2 - Mex3**2)**2 - 2*Mex1**2*(Mex2**2 + Mex3**2)))/(16._dp*Mex3**2) 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(3)*Conjg(AmplitudeC(3)) 

! Mat[<v1|6|v2>] Pair[ec[3], k[1]] x Mat[<v1|7|v2>] Pair[ec[3], k[1]]
LorentzFactor = (Mex1*Mex2*(Mex1**4 + (Mex2**2 - Mex3**2)**2 - 2*Mex1**2*(Mex2**2 + Mex3**2)))/(8._dp*Mex3**2) 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(3)*Conjg(AmplitudeC(4)) 

! Mat[<v1|7|v2>] Pair[ec[3], k[1]] x Mat[<v1|6,ec[3]|v2>]
LorentzFactor = -(Mex1*(Mex1**4 + (Mex2**2 - Mex3**2)**2 - 2*Mex1**2*(Mex2**2 + Mex3**2)))/(8._dp*Mex3**2) 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(4)*Conjg(AmplitudeC(1)) 

! Mat[<v1|7|v2>] Pair[ec[3], k[1]] x Mat[<v1|7,ec[3]|v2>]
LorentzFactor = -(Mex2*(Mex1**4 + (Mex2**2 - Mex3**2)**2 - 2*Mex1**2*(Mex2**2 + Mex3**2)))/(8._dp*Mex3**2) 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(4)*Conjg(AmplitudeC(2)) 

! Mat[<v1|7|v2>] Pair[ec[3], k[1]] x Mat[<v1|6|v2>] Pair[ec[3], k[1]]
LorentzFactor = (Mex1*Mex2*(Mex1**4 + (Mex2**2 - Mex3**2)**2 - 2*Mex1**2*(Mex2**2 + Mex3**2)))/(8._dp*Mex3**2) 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(4)*Conjg(AmplitudeC(3)) 

! Mat[<v1|7|v2>] Pair[ec[3], k[1]] x Mat[<v1|7|v2>] Pair[ec[3], k[1]]
LorentzFactor = ((Mex1**2 + Mex2**2 - Mex3**2)*(Mex1**4 + (Mex2**2 - Mex3**2)**2 - 2*Mex1**2*(Mex2**2 + Mex3**2)))/(16._dp*Mex3**2) 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(4)*Conjg(AmplitudeC(4)) 

Else 

! et = Mex1-Mex2


! ! Mat[<v1|6,ec[3]|v2>] x Mat[<v1|6,ec[3]|v2>]
! LorentzFactor = (Mex1**2 + Mex2**2)/2._dp 
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(1)*Conjg(AmplitudeC(1)) 

! ! Mat[<v1|6,ec[3]|v2>] x Mat[<v1|7,ec[3]|v2>]
! LorentzFactor = (-Mex1*Mex2)
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(1)*Conjg(AmplitudeC(2)) 

! ! Mat[<v1|6,ec[3]|v2>] x Mat[<v1|6|v2>] Pair[ec[3], k[1]]
! LorentzFactor = -Mex2*et
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(1)*Conjg(AmplitudeC(3)) 

! ! Mat[<v1|6,ec[3]|v2>] x Mat[<v1|7|v2>] Pair[ec[3], k[1]]
! LorentzFactor = -Mex1*et
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(1)*Conjg(AmplitudeC(4)) 

! ! Mat[<v1|7,ec[3]|v2>] x Mat[<v1|6,ec[3]|v2>]
! LorentzFactor = (-Mex1*Mex2)
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(2)*Conjg(AmplitudeC(1)) 

! ! Mat[<v1|7,ec[3]|v2>] x Mat[<v1|7,ec[3]|v2>]
! LorentzFactor = (Mex1**2 + Mex2**2)/2._dp  
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(2)*Conjg(AmplitudeC(2)) 

! ! Mat[<v1|7,ec[3]|v2>] x Mat[<v1|6|v2>] Pair[ec[3], k[1]]
! LorentzFactor = -Mex1*et
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(2)*Conjg(AmplitudeC(3)) 

! ! Mat[<v1|7,ec[3]|v2>] x Mat[<v1|7|v2>] Pair[ec[3], k[1]]
! LorentzFactor = -Mex2*et
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(2)*Conjg(AmplitudeC(4)) 

! ! Mat[<v1|6|v2>] Pair[ec[3], k[1]] x Mat[<v1|6,ec[3]|v2>]
! LorentzFactor = -Mex2*et
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(3)*Conjg(AmplitudeC(1)) 

! ! Mat[<v1|6|v2>] Pair[ec[3], k[1]] x Mat[<v1|7,ec[3]|v2>]
! LorentzFactor = -Mex1*et
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(3)*Conjg(AmplitudeC(2)) 

! ! Mat[<v1|6|v2>] Pair[ec[3], k[1]] x Mat[<v1|6|v2>] Pair[ec[3], k[1]]
! LorentzFactor = (Mex1**2 + Mex2**2)/2._dp 
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(3)*Conjg(AmplitudeC(3)) 

! ! Mat[<v1|6|v2>] Pair[ec[3], k[1]] x Mat[<v1|7|v2>] Pair[ec[3], k[1]]
! LorentzFactor = Mex1*Mex2
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(3)*Conjg(AmplitudeC(4)) 

! ! Mat[<v1|7|v2>] Pair[ec[3], k[1]] x Mat[<v1|6,ec[3]|v2>]
! LorentzFactor = -Mex1*et
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(4)*Conjg(AmplitudeC(1)) 

! ! Mat[<v1|7|v2>] Pair[ec[3], k[1]] x Mat[<v1|7,ec[3]|v2>]
! LorentzFactor = -Mex2*et
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(4)*Conjg(AmplitudeC(2)) 

! ! Mat[<v1|7|v2>] Pair[ec[3], k[1]] x Mat[<v1|6|v2>] Pair[ec[3], k[1]]
! LorentzFactor = Mex1*Mex2
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(4)*Conjg(AmplitudeC(3)) 

! ! Mat[<v1|7|v2>] Pair[ec[3], k[1]] x Mat[<v1|7|v2>] Pair[ec[3], k[1]]
! LorentzFactor = (Mex1**2 + Mex2**2)/2._dp 
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(4)*Conjg(AmplitudeC(4))


!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

! ! Mat[<v1|6,ec[3]|v2>] x Mat[<v1|6,ec[3]|v2>]
! LorentzFactor = -(Mex2**2 - Mex1**2)/2._dp 
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(1)*Conjg(AmplitudeC(1)) 

! ! Mat[<v1|6,ec[3]|v2>] x Mat[<v1|7,ec[3]|v2>]
! LorentzFactor = (Mex1*Mex2)
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(1)*Conjg(AmplitudeC(2)) 

! ! Mat[<v1|6,ec[3]|v2>] x Mat[<v1|6|v2>] Pair[ec[3], k[1]]
! LorentzFactor = -Mex2*Mex1**2/2._dp
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(1)*Conjg(AmplitudeC(3)) 

! ! Mat[<v1|6,ec[3]|v2>] x Mat[<v1|7|v2>] Pair[ec[3], k[1]]
! LorentzFactor = -(Mex1**3)/2._dp
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(1)*Conjg(AmplitudeC(4)) 

! ! Mat[<v1|7,ec[3]|v2>] x Mat[<v1|6,ec[3]|v2>]
! LorentzFactor = (Mex1*Mex2)
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(2)*Conjg(AmplitudeC(1)) 

! ! Mat[<v1|7,ec[3]|v2>] x Mat[<v1|7,ec[3]|v2>]
! LorentzFactor = -(Mex2**2 - Mex1**2)/2._dp  
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(2)*Conjg(AmplitudeC(2)) 

! ! Mat[<v1|7,ec[3]|v2>] x Mat[<v1|6|v2>] Pair[ec[3], k[1]]
! LorentzFactor = -(Mex1**3)/2._dp
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(2)*Conjg(AmplitudeC(3)) 

! ! Mat[<v1|7,ec[3]|v2>] x Mat[<v1|7|v2>] Pair[ec[3], k[1]]
! LorentzFactor = -(Mex2*Mex1**2)/2._dp
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(2)*Conjg(AmplitudeC(4)) 

! ! Mat[<v1|6|v2>] Pair[ec[3], k[1]] x Mat[<v1|6,ec[3]|v2>]
! LorentzFactor = -Mex2*Mex1**2/2._dp
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(3)*Conjg(AmplitudeC(1)) 

! ! Mat[<v1|6|v2>] Pair[ec[3], k[1]] x Mat[<v1|7,ec[3]|v2>]
! LorentzFactor = -(Mex1**3)/2._dp
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(3)*Conjg(AmplitudeC(2)) 

! ! Mat[<v1|6|v2>] Pair[ec[3], k[1]] x Mat[<v1|6|v2>] Pair[ec[3], k[1]]
! LorentzFactor = (Mex1**2)*(Mex1**2 + Mex2**2)/2._dp 
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(3)*Conjg(AmplitudeC(3)) 

! ! Mat[<v1|6|v2>] Pair[ec[3], k[1]] x Mat[<v1|7|v2>] Pair[ec[3], k[1]]
! LorentzFactor = (Mex1**3)*Mex2/2._dp
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(3)*Conjg(AmplitudeC(4)) 

! ! Mat[<v1|7|v2>] Pair[ec[3], k[1]] x Mat[<v1|6,ec[3]|v2>]
! LorentzFactor = -(Mex1**3)/2._dp
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(4)*Conjg(AmplitudeC(1)) 

! ! Mat[<v1|7|v2>] Pair[ec[3], k[1]] x Mat[<v1|7,ec[3]|v2>]
! LorentzFactor = -Mex2*(Mex1**2)/2._dp
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(4)*Conjg(AmplitudeC(2)) 

! ! Mat[<v1|7|v2>] Pair[ec[3], k[1]] x Mat[<v1|6|v2>] Pair[ec[3], k[1]]
! LorentzFactor = (Mex2*Mex1**3)/2._dp
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(4)*Conjg(AmplitudeC(3)) 

! ! Mat[<v1|7|v2>] Pair[ec[3], k[1]] x Mat[<v1|7|v2>] Pair[ec[3], k[1]]
! LorentzFactor = Mex1**2*(Mex1**2 + Mex2**2)/2._dp 
! AmpSquared = AmpSquared + LorentzFactor*Amplitude(4)*Conjg(AmplitudeC(4))
   

   
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!! NEW VERSION BY MARK
!et = Mex1-Mex2

! Mat[<v1|6,ec[3]|v2>] x Mat[<v1|6,ec[3]|v2>]
LorentzFactor = (Mex2**2 + Mex1**2)
AmpSquared = AmpSquared + LorentzFactor*Amplitude(1)*Conjg(AmplitudeC(1)) 

! Mat[<v1|6,ec[3]|v2>] x Mat[<v1|7,ec[3]|v2>]
LorentzFactor = -4._dp*(Mex1*Mex2)
AmpSquared = AmpSquared + LorentzFactor*Amplitude(1)*Conjg(AmplitudeC(2)) 

! Mat[<v1|6,ec[3]|v2>] x Mat[<v1|6|v2>] Pair[ec[3], k[1]]
LorentzFactor = Mex2*Mex1**2
AmpSquared = AmpSquared + LorentzFactor*Amplitude(1)*Conjg(AmplitudeC(3)) 

! Mat[<v1|6,ec[3]|v2>] x Mat[<v1|7|v2>] Pair[ec[3], k[1]]
LorentzFactor = (Mex1*(Mex1**2+Mex2**2))/2._dp
AmpSquared = AmpSquared + LorentzFactor*Amplitude(1)*Conjg(AmplitudeC(4)) 



! Mat[<v1|7,ec[3]|v2>] x Mat[<v1|6,ec[3]|v2>]
LorentzFactor = -4._dp*(Mex1*Mex2)
AmpSquared = AmpSquared + LorentzFactor*Amplitude(2)*Conjg(AmplitudeC(1)) 

! Mat[<v1|7,ec[3]|v2>] x Mat[<v1|7,ec[3]|v2>]
LorentzFactor = (Mex2**2 + Mex1**2) 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(2)*Conjg(AmplitudeC(2)) 

! Mat[<v1|7,ec[3]|v2>] x Mat[<v1|6|v2>] Pair[ec[3], k[1]]
LorentzFactor = (Mex1*(Mex1**2 + Mex2**2))/2._dp
AmpSquared = AmpSquared + LorentzFactor*Amplitude(2)*Conjg(AmplitudeC(3)) 

! Mat[<v1|7,ec[3]|v2>] x Mat[<v1|7|v2>] Pair[ec[3], k[1]]
LorentzFactor = (Mex2*Mex1**2)
AmpSquared = AmpSquared + LorentzFactor*Amplitude(2)*Conjg(AmplitudeC(4)) 



! Mat[<v1|6|v2>] Pair[ec[3], k[1]] x Mat[<v1|6,ec[3]|v2>]
LorentzFactor = Mex2*Mex1**2
AmpSquared = AmpSquared + LorentzFactor*Amplitude(3)*Conjg(AmplitudeC(1)) 

! Mat[<v1|6|v2>] Pair[ec[3], k[1]] x Mat[<v1|7,ec[3]|v2>]
LorentzFactor = Mex1*(Mex1**2 + Mex2**2)/2._dp
AmpSquared = AmpSquared + LorentzFactor*Amplitude(3)*Conjg(AmplitudeC(2)) 

! Mat[<v1|6|v2>] Pair[ec[3], k[1]] x Mat[<v1|6|v2>] Pair[ec[3], k[1]]
LorentzFactor = -(Mex1**2)*(Mex1**2 + Mex2**2)/2._dp 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(3)*Conjg(AmplitudeC(3)) 

! Mat[<v1|6|v2>] Pair[ec[3], k[1]] x Mat[<v1|7|v2>] Pair[ec[3], k[1]]
LorentzFactor = -(Mex1**3)*Mex2
AmpSquared = AmpSquared + LorentzFactor*Amplitude(3)*Conjg(AmplitudeC(4)) 



! Mat[<v1|7|v2>] Pair[ec[3], k[1]] x Mat[<v1|6,ec[3]|v2>]
LorentzFactor = (Mex1*(Mex1**2+Mex2**2))/2._dp
AmpSquared = AmpSquared + LorentzFactor*Amplitude(4)*Conjg(AmplitudeC(1)) 

! Mat[<v1|7|v2>] Pair[ec[3], k[1]] x Mat[<v1|7,ec[3]|v2>]
LorentzFactor = Mex2*(Mex1**2)
AmpSquared = AmpSquared + LorentzFactor*Amplitude(4)*Conjg(AmplitudeC(2)) 

! Mat[<v1|7|v2>] Pair[ec[3], k[1]] x Mat[<v1|6|v2>] Pair[ec[3], k[1]]
LorentzFactor = -(Mex2*Mex1**3)
AmpSquared = AmpSquared + LorentzFactor*Amplitude(4)*Conjg(AmplitudeC(3)) 

! Mat[<v1|7|v2>] Pair[ec[3], k[1]] x Mat[<v1|7|v2>] Pair[ec[3], k[1]]
LorentzFactor = -Mex1**2*(Mex1**2 + Mex2**2)/2._dp 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(4)*Conjg(AmplitudeC(4))

!!!!!!!!!!!!!!!!!!!!!!!! CLEAN VERSION 2019-08-07 BY MARK

ampsquared =0.5_dp*ampsquared

!!!!!! GIVE SAFE VERSION INSTEAD, DON'T WANT NEGATIVE VALUES:

AmpSquared=0.5_dp*real((Mex1**2+Mex2**2)*(amplitude(1)*conjg(amplitudeC(1))+amplitude(2)*conjg(amplitudeC(2)))-2._dp*Mex1*Mex2*(amplitude(1)*conjg(amplitudeC(2))+amplitude(2)*conjg(amplitudeC(1))),dp)


! write(*,*) "Masses: ",mex1,mex2,mex3

! write(*,*) "Amplitude: ",amplitude
! write(*,*) "Ward ID 1: ",amplitude(3)," =?= ",-2._dp*(Mex2*amplitude(1)-Mex1*amplitude(2))/(Mex1**2-Mex2**2)
! write(*,*) "Ward ID 2: ",amplitude(4)," =?= ",-2._dp*(Mex2*amplitude(2)-Mex1*amplitude(1))/(Mex1**2-Mex2**2)

! write(*,*) "Amp squared: ",AmpSquared
! write(*,*) "alternative amp squared: ",(Mex1**2+Mex2**2)*(amplitude(1)*conjg(amplitudeC(1))+amplitude(2)*conjg(amplitudeC(2)))-2._dp*Mex1*Mex2*(amplitude(1)*conjg(amplitudeC(2))+amplitude(2)*conjg(amplitudeC(1)))

End if


End Subroutine SquareAmp_FtoFV
End Module DecayFFV
 
