! Code automatically generated by 'PreSARAH'  
! Expressions for amplitudes are obtained by FeynArts/FormCalc  
! Created at 10:37 on 11.11.2016  
 
 
Module DecaySFF 

Use Control 
Use LoopFunctions 
Use AddLoopFunctions 
Use Settings

Contains 

Subroutine TreeAmp_StoFF(Mex1,Mex2,Mex3,coupT1L, coupT1R,Amplitude)
Implicit None 
Real(dp), Intent(in) :: Mex1,Mex2,Mex3 
Complex(dp), Intent(out) :: Amplitude(2) 
Complex(dp), Intent(in) :: coupT1L, coupT1R 

Amplitude = 0._dp

! Now the full amplitude for the different Lorentz Parts 
! Coefficient of Mat[<u2|6|v3>] 
Amplitude(1)= -1*(0.,1._dp)*coupT1R 


! Coefficient of Mat[<u2|7|v3>] 
Amplitude(2)= -1*(0.,1._dp)*coupT1L 


End Subroutine TreeAmp_StoFF

! -------------------------------------- 
! Topology Nr.1
! -------------------------------------- 

Subroutine Amp_VERTEX_StoFF_Topology1_FFS(Mex1,Mex2,Mex3,ML1, ML2, ML3,coup1L, coup1R, coup2L, coup2R, coup3L, coup3R,Amplitude)
Implicit None 
Real(dp), Intent(in) :: Mex1,Mex2,Mex3 
Complex(dp), Intent(out) :: Amplitude(2) 
Real(dp), Intent(in) :: ML1, ML2, ML3 
Complex(dp), Intent(in) :: coup1L, coup1R, coup2L, coup2R, coup3L, coup3R 
Complex(dp) :: int1,int2,int3,int4,int5,int6,int7,int8,int9,int10 

Amplitude = 0._dp

! Necessary Loop Integrals 
int1=SA_B0(Mex3**2,ML2**2,ML3**2)
int2=SA_Cget("C0  ",Mex1**2,Mex3**2,Mex2**2,ML1**2,ML2**2,ML3**2)
int3=SA_Cget("C1  ",Mex1**2,Mex3**2,Mex2**2,ML1**2,ML2**2,ML3**2)
int4=SA_Cget("C2  ",Mex1**2,Mex3**2,Mex2**2,ML1**2,ML2**2,ML3**2)


! Now the full amplitude for the different Lorentz Parts 
! Coefficient of Mat[<u2|6|v3>] 
Amplitude(1)= & 
& +(1*(0.,1._dp)*coup1L*coup2R*coup3R*int1) & 
& +(1*(0.,1._dp)*coup1L*coup2R*coup3R*int3*Mex1**2) & 
& +(1*(0.,1._dp)*coup1L*coup2R*coup3R*int4*Mex2**2) & 
& +(-1*(0.,1._dp)*coup1R*coup2L*coup3L*int4*Mex2*Mex3) & 
& +(-1*(0.,1._dp)*coup1L*coup2L*coup3R*int2*Mex2*ML1) & 
& +(-1*(0.,1._dp)*coup1L*coup2L*coup3R*int3*Mex2*ML1) & 
& +(-1*(0.,1._dp)*coup1L*coup2L*coup3R*int4*Mex2*ML1) & 
& +(1*(0.,1._dp)*coup1R*coup2R*coup3L*int2*Mex3*ML1) & 
& +(1*(0.,1._dp)*coup1R*coup2R*coup3L*int3*Mex3*ML1) & 
& +(1*(0.,1._dp)*coup1L*coup2R*coup3R*int2*ML1**2) & 
& +(-1*(0.,1._dp)*coup1R*coup2L*coup3R*int3*Mex2*ML2) & 
& +(-1*(0.,1._dp)*coup1R*coup2L*coup3R*int4*Mex2*ML2) & 
& +(1*(0.,1._dp)*coup1L*coup2R*coup3L*int3*Mex3*ML2) & 
& +(1*(0.,1._dp)*coup1R*coup2R*coup3R*int2*ML1*ML2)



! Coefficient of Mat[<u2|7|v3>] 
Amplitude(2)= & 
& +(1*(0.,1._dp)*coup1R*coup2L*coup3L*int1) & 
& +(1*(0.,1._dp)*coup1R*coup2L*coup3L*int3*Mex1**2) & 
& +(1*(0.,1._dp)*coup1R*coup2L*coup3L*int4*Mex2**2) & 
& +(-1*(0.,1._dp)*coup1L*coup2R*coup3R*int4*Mex2*Mex3) & 
& +(-1*(0.,1._dp)*coup1R*coup2R*coup3L*int2*Mex2*ML1) & 
& +(-1*(0.,1._dp)*coup1R*coup2R*coup3L*int3*Mex2*ML1) & 
& +(-1*(0.,1._dp)*coup1R*coup2R*coup3L*int4*Mex2*ML1) & 
& +(1*(0.,1._dp)*coup1L*coup2L*coup3R*int2*Mex3*ML1) & 
& +(1*(0.,1._dp)*coup1L*coup2L*coup3R*int3*Mex3*ML1) & 
& +(1*(0.,1._dp)*coup1R*coup2L*coup3L*int2*ML1**2) & 
& +(-1*(0.,1._dp)*coup1L*coup2R*coup3L*int3*Mex2*ML2) & 
& +(-1*(0.,1._dp)*coup1L*coup2R*coup3L*int4*Mex2*ML2) & 
& +(1*(0.,1._dp)*coup1R*coup2L*coup3R*int3*Mex3*ML2) & 
& +(1*(0.,1._dp)*coup1L*coup2L*coup3L*int2*ML1*ML2)

If ((Abs(Amplitude(1))).ne.(Abs(Amplitude(1)))) Then
Amplitude=0._dp
End if

!Field Order 
! FieldOrder[1,{F, F, S},1]={Internal[1][i1], AntiField[Internal[2]][i2], External[1][gt1]}; 
! FieldOrder[1,{F, F, S},2]={External[2][gt2], AntiField[Internal[1]][i1], Internal[3][i3]}; 
! FieldOrder[1,{F, F, S},3]={Internal[2][i2], External[3][gt3], AntiField[Internal[3]][i3]}; 
! ExtraSign[1,{F, F, S},1]=1; 
! ExtraSign[1,{F, F, S},2]=1; 
! ExtraSign[1,{F, F, S},3]=1; 
End Subroutine Amp_VERTEX_StoFF_Topology1_FFS

Subroutine Amp_VERTEX_StoFF_Topology1_SSF(Mex1,Mex2,Mex3,ML1, ML2, ML3,coup1, coup2L, coup2R, coup3L, coup3R,Amplitude)
Implicit None 
Real(dp), Intent(in) :: Mex1,Mex2,Mex3 
Complex(dp), Intent(out) :: Amplitude(2) 
Real(dp), Intent(in) :: ML1, ML2, ML3 
Complex(dp), Intent(in) :: coup1, coup2L, coup2R, coup3L, coup3R 
Complex(dp) :: int1,int2,int3,int4,int5,int6,int7,int8,int9,int10 

Amplitude = 0._dp

! Necessary Loop Integrals 
int1=SA_Cget("C0  ",Mex2**2,Mex1**2,Mex3**2,ML3**2,ML1**2,ML2**2)
int2=SA_Cget("C1  ",Mex2**2,Mex1**2,Mex3**2,ML3**2,ML1**2,ML2**2)
int3=SA_Cget("C2  ",Mex2**2,Mex1**2,Mex3**2,ML3**2,ML1**2,ML2**2)


! Now the full amplitude for the different Lorentz Parts 
! Coefficient of Mat[<u2|6|v3>] 
Amplitude(1)= & 
& +(-1*(0.,1._dp)*coup1*coup2L*coup3R*int2*Mex2) & 
& +(-1*(0.,1._dp)*coup1*coup2R*coup3L*int3*Mex3) & 
& +(1*(0.,1._dp)*coup1*coup2R*coup3R*int1*ML3)



! Coefficient of Mat[<u2|7|v3>] 
Amplitude(2)= & 
& +(-1*(0.,1._dp)*coup1*coup2R*coup3L*int2*Mex2) & 
& +(-1*(0.,1._dp)*coup1*coup2L*coup3R*int3*Mex3) & 
& +(1*(0.,1._dp)*coup1*coup2L*coup3L*int1*ML3)

If ((Abs(Amplitude(1))).ne.(Abs(Amplitude(1)))) Then
Amplitude=0._dp
End if

!Field Order 
! FieldOrder[1,{S, S, F},1]={External[1][gt1], Internal[1][i1], AntiField[Internal[2]][i2]}; 
! FieldOrder[1,{S, S, F},2]={External[2][gt2], Internal[3][i3], AntiField[Internal[1]][i1]}; 
! FieldOrder[1,{S, S, F},3]={AntiField[Internal[3]][i3], External[3][gt3], Internal[2][i2]}; 
! ExtraSign[1,{S, S, F},1]=1; 
! ExtraSign[1,{S, S, F},2]=1; 
! ExtraSign[1,{S, S, F},3]=1; 
End Subroutine Amp_VERTEX_StoFF_Topology1_SSF

Subroutine Amp_VERTEX_StoFF_Topology1_FFV(Mex1,Mex2,Mex3,ML1, ML2, ML3,coup1L, coup1R, coup2L, coup2R, coup3L, coup3R,Amplitude)
Implicit None 
Real(dp), Intent(in) :: Mex1,Mex2,Mex3 
Complex(dp), Intent(out) :: Amplitude(2) 
Real(dp), Intent(in) :: ML1, ML2, ML3 
Complex(dp), Intent(in) :: coup1L, coup1R, coup2L, coup2R, coup3L, coup3R 
Complex(dp) :: int1,int2,int3,int4,int5,int6,int7,int8,int9,int10 

Amplitude = 0._dp

! Necessary Loop Integrals 
int1=SA_B0(Mex3**2,ML2**2,ML3**2)
int2=SA_Cget("C0  ",Mex1**2,Mex3**2,Mex2**2,ML1**2,ML2**2,ML3**2)
int3=SA_Cget("C1  ",Mex1**2,Mex3**2,Mex2**2,ML1**2,ML2**2,ML3**2)
int4=SA_Cget("C2  ",Mex1**2,Mex3**2,Mex2**2,ML1**2,ML2**2,ML3**2)


! Now the full amplitude for the different Lorentz Parts 
! Coefficient of Mat[<u2|6|v3>] 
Amplitude(1)= & 
& +(2*(0.,1._dp)*coup1R*coup2L*coup3R*rMS) & 
& +(-4*(0.,1._dp)*coup1R*coup2L*coup3R*int1) & 
& +(-4*(0.,1._dp)*coup1R*coup2L*coup3R*int3*Mex1**2) & 
& +(-2*(0.,1._dp)*coup1R*coup2L*coup3R*int4*Mex1**2) & 
& +(-2*(0.,1._dp)*coup1R*coup2L*coup3R*int4*Mex2**2) & 
& +(2*(0.,1._dp)*coup1R*coup2L*coup3R*int4*Mex3**2) & 
& +(-2*(0.,1._dp)*coup1R*coup2R*coup3R*int2*Mex2*ML1) & 
& +(-2*(0.,1._dp)*coup1R*coup2R*coup3R*int3*Mex2*ML1) & 
& +(-2*(0.,1._dp)*coup1R*coup2R*coup3R*int4*Mex2*ML1) & 
& +(2*(0.,1._dp)*coup1L*coup2L*coup3L*int2*Mex3*ML1) & 
& +(2*(0.,1._dp)*coup1L*coup2L*coup3L*int3*Mex3*ML1) & 
& +(-4*(0.,1._dp)*coup1R*coup2L*coup3R*int2*ML1**2) & 
& +(-2*(0.,1._dp)*coup1L*coup2R*coup3R*int3*Mex2*ML2) & 
& +(-2*(0.,1._dp)*coup1L*coup2R*coup3R*int4*Mex2*ML2) & 
& +(2*(0.,1._dp)*coup1R*coup2L*coup3L*int3*Mex3*ML2) & 
& +(-4*(0.,1._dp)*coup1L*coup2L*coup3R*int2*ML1*ML2)



! Coefficient of Mat[<u2|7|v3>] 
Amplitude(2)= & 
& +(2*(0.,1._dp)*coup1L*coup2R*coup3L*rMS) & 
& +(-4*(0.,1._dp)*coup1L*coup2R*coup3L*int1) & 
& +(-4*(0.,1._dp)*coup1L*coup2R*coup3L*int3*Mex1**2) & 
& +(-2*(0.,1._dp)*coup1L*coup2R*coup3L*int4*Mex1**2) & 
& +(-2*(0.,1._dp)*coup1L*coup2R*coup3L*int4*Mex2**2) & 
& +(2*(0.,1._dp)*coup1L*coup2R*coup3L*int4*Mex3**2) & 
& +(-2*(0.,1._dp)*coup1L*coup2L*coup3L*int2*Mex2*ML1) & 
& +(-2*(0.,1._dp)*coup1L*coup2L*coup3L*int3*Mex2*ML1) & 
& +(-2*(0.,1._dp)*coup1L*coup2L*coup3L*int4*Mex2*ML1) & 
& +(2*(0.,1._dp)*coup1R*coup2R*coup3R*int2*Mex3*ML1) & 
& +(2*(0.,1._dp)*coup1R*coup2R*coup3R*int3*Mex3*ML1) & 
& +(-4*(0.,1._dp)*coup1L*coup2R*coup3L*int2*ML1**2) & 
& +(-2*(0.,1._dp)*coup1R*coup2L*coup3L*int3*Mex2*ML2) & 
& +(-2*(0.,1._dp)*coup1R*coup2L*coup3L*int4*Mex2*ML2) & 
& +(2*(0.,1._dp)*coup1L*coup2R*coup3R*int3*Mex3*ML2) & 
& +(-4*(0.,1._dp)*coup1R*coup2R*coup3L*int2*ML1*ML2)

If ((Abs(Amplitude(1))).ne.(Abs(Amplitude(1)))) Then
Amplitude=0._dp
End if

!Field Order 
! FieldOrder[1,{F, F, V},1]={Internal[1][i1], AntiField[Internal[2]][i2], External[1][gt1]}; 
! FieldOrder[1,{F, F, V},2]={External[2][gt2], AntiField[Internal[1]][i1], Internal[3][i3]}; 
! FieldOrder[1,{F, F, V},3]={Internal[2][i2], External[3][gt3], AntiField[Internal[3]][i3]}; 
! ExtraSign[1,{F, F, V},1]=1; 
! ExtraSign[1,{F, F, V},2]=1; 
! ExtraSign[1,{F, F, V},3]=1; 
End Subroutine Amp_VERTEX_StoFF_Topology1_FFV

Subroutine Amp_VERTEX_StoFF_Topology1_SVF(Mex1,Mex2,Mex3,ML1, ML2, ML3,coup1, coup2L, coup2R, coup3L, coup3R,Amplitude)
Implicit None 
Real(dp), Intent(in) :: Mex1,Mex2,Mex3 
Complex(dp), Intent(out) :: Amplitude(2) 
Real(dp), Intent(in) :: ML1, ML2, ML3 
Complex(dp), Intent(in) :: coup1, coup2L, coup2R, coup3L, coup3R 
Complex(dp) :: int1,int2,int3,int4,int5,int6,int7,int8,int9,int10 

Amplitude = 0._dp

! Necessary Loop Integrals 
int1=SA_B0(Mex3**2,ML3**2,ML2**2)
int2=SA_Cget("C0  ",Mex2**2,Mex1**2,Mex3**2,ML3**2,ML1**2,ML2**2)
int3=SA_Cget("C1  ",Mex2**2,Mex1**2,Mex3**2,ML3**2,ML1**2,ML2**2)
int4=SA_Cget("C2  ",Mex2**2,Mex1**2,Mex3**2,ML3**2,ML1**2,ML2**2)


! Now the full amplitude for the different Lorentz Parts 
! Coefficient of Mat[<u2|6|v3>] 
Amplitude(1)= & 
& +(1*(0.,1._dp)*coup1*coup2R*coup3R*int1) & 
& +(-1*(0.,1._dp)*coup1*coup2R*coup3R*int4*Mex1**2) & 
& +(-1*(0.,1._dp)*coup1*coup2R*coup3R*int2*Mex2**2) & 
& +(1*(0.,1._dp)*coup1*coup2R*coup3R*int4*Mex2**2) & 
& +(-1*(0.,1._dp)*coup1*coup2L*coup3L*int3*Mex2*Mex3) & 
& +(-2*(0.,1._dp)*coup1*coup2L*coup3L*int4*Mex2*Mex3) & 
& +(1*(0.,1._dp)*coup1*coup2R*coup3R*int2*ML1**2) & 
& +(-2*(0.,1._dp)*coup1*coup2L*coup3R*int2*Mex2*ML3) & 
& +(-1*(0.,1._dp)*coup1*coup2L*coup3R*int3*Mex2*ML3) & 
& +(1*(0.,1._dp)*coup1*coup2R*coup3L*int2*Mex3*ML3) & 
& +(-1*(0.,1._dp)*coup1*coup2R*coup3L*int4*Mex3*ML3)



! Coefficient of Mat[<u2|7|v3>] 
Amplitude(2)= & 
& +(1*(0.,1._dp)*coup1*coup2L*coup3L*int1) & 
& +(-1*(0.,1._dp)*coup1*coup2L*coup3L*int4*Mex1**2) & 
& +(-1*(0.,1._dp)*coup1*coup2L*coup3L*int2*Mex2**2) & 
& +(1*(0.,1._dp)*coup1*coup2L*coup3L*int4*Mex2**2) & 
& +(-1*(0.,1._dp)*coup1*coup2R*coup3R*int3*Mex2*Mex3) & 
& +(-2*(0.,1._dp)*coup1*coup2R*coup3R*int4*Mex2*Mex3) & 
& +(1*(0.,1._dp)*coup1*coup2L*coup3L*int2*ML1**2) & 
& +(-2*(0.,1._dp)*coup1*coup2R*coup3L*int2*Mex2*ML3) & 
& +(-1*(0.,1._dp)*coup1*coup2R*coup3L*int3*Mex2*ML3) & 
& +(1*(0.,1._dp)*coup1*coup2L*coup3R*int2*Mex3*ML3) & 
& +(-1*(0.,1._dp)*coup1*coup2L*coup3R*int4*Mex3*ML3)

Amplitude=-Amplitude

If ((Abs(Amplitude(1))).ne.(Abs(Amplitude(1)))) Then
Amplitude=0._dp
End if
!Field Order 
! FieldOrder[1,{S, V, F},1]={External[1][gt1], Internal[1][i1], AntiField[Internal[2]][i2]}; 
! FieldOrder[1,{S, V, F},2]={External[2][gt2], Internal[3][i3], AntiField[Internal[1]][i1]}; 
! FieldOrder[1,{S, V, F},3]={AntiField[Internal[3]][i3], External[3][gt3], Internal[2][i2]}; 
! ExtraSign[1,{S, V, F},1]=-1; 
! ExtraSign[1,{S, V, F},2]=1; 
! ExtraSign[1,{S, V, F},3]=1; 
End Subroutine Amp_VERTEX_StoFF_Topology1_SVF

Subroutine Amp_VERTEX_StoFF_Topology1_VSF(Mex1,Mex2,Mex3,ML1, ML2, ML3,coup1, coup2L, coup2R, coup3L, coup3R,Amplitude)
Implicit None 
Real(dp), Intent(in) :: Mex1,Mex2,Mex3 
Complex(dp), Intent(out) :: Amplitude(2) 
Real(dp), Intent(in) :: ML1, ML2, ML3 
Complex(dp), Intent(in) :: coup1, coup2L, coup2R, coup3L, coup3R 
Complex(dp) :: int1,int2,int3,int4,int5,int6,int7,int8,int9,int10 

Amplitude = 0._dp

! Necessary Loop Integrals 
int1=SA_B0(Mex3**2,ML3**2,ML2**2)
int2=SA_Cget("C0  ",Mex2**2,Mex1**2,Mex3**2,ML3**2,ML1**2,ML2**2)
int3=SA_Cget("C1  ",Mex2**2,Mex1**2,Mex3**2,ML3**2,ML1**2,ML2**2)
int4=SA_Cget("C2  ",Mex2**2,Mex1**2,Mex3**2,ML3**2,ML1**2,ML2**2)


! Now the full amplitude for the different Lorentz Parts 
! Coefficient of Mat[<u2|6|v3>] 
Amplitude(1)= & 
& +(-1*(0.,1._dp)*coup1*coup2L*coup3R*int1) & 
& +(2*(0.,1._dp)*coup1*coup2L*coup3R*int3*Mex1**2) & 
& +(-1*(0.,1._dp)*coup1*coup2L*coup3R*int4*Mex1**2) & 
& +(1*(0.,1._dp)*coup1*coup2L*coup3R*int2*Mex2**2) & 
& +(1*(0.,1._dp)*coup1*coup2L*coup3R*int3*Mex2**2) & 
& +(1*(0.,1._dp)*coup1*coup2L*coup3R*int4*Mex2**2) & 
& +(2*(0.,1._dp)*coup1*coup2R*coup3L*int3*Mex2*Mex3) & 
& +(1*(0.,1._dp)*coup1*coup2R*coup3L*int4*Mex2*Mex3) & 
& +(-2*(0.,1._dp)*coup1*coup2L*coup3R*int3*Mex3**2) & 
& +(-1*(0.,1._dp)*coup1*coup2L*coup3R*int4*Mex3**2) & 
& +(-1*(0.,1._dp)*coup1*coup2L*coup3R*int2*ML1**2) & 
& +(-1*(0.,1._dp)*coup1*coup2R*coup3R*int2*Mex2*ML3) & 
& +(1*(0.,1._dp)*coup1*coup2R*coup3R*int3*Mex2*ML3) & 
& +(2*(0.,1._dp)*coup1*coup2L*coup3L*int2*Mex3*ML3) & 
& +(1*(0.,1._dp)*coup1*coup2L*coup3L*int4*Mex3*ML3)



! Coefficient of Mat[<u2|7|v3>] 
Amplitude(2)= & 
& +(-1*(0.,1._dp)*coup1*coup2R*coup3L*int1) & 
& +(2*(0.,1._dp)*coup1*coup2R*coup3L*int3*Mex1**2) & 
& +(-1*(0.,1._dp)*coup1*coup2R*coup3L*int4*Mex1**2) & 
& +(1*(0.,1._dp)*coup1*coup2R*coup3L*int2*Mex2**2) & 
& +(1*(0.,1._dp)*coup1*coup2R*coup3L*int3*Mex2**2) & 
& +(1*(0.,1._dp)*coup1*coup2R*coup3L*int4*Mex2**2) & 
& +(2*(0.,1._dp)*coup1*coup2L*coup3R*int3*Mex2*Mex3) & 
& +(1*(0.,1._dp)*coup1*coup2L*coup3R*int4*Mex2*Mex3) & 
& +(-2*(0.,1._dp)*coup1*coup2R*coup3L*int3*Mex3**2) & 
& +(-1*(0.,1._dp)*coup1*coup2R*coup3L*int4*Mex3**2) & 
& +(-1*(0.,1._dp)*coup1*coup2R*coup3L*int2*ML1**2) & 
& +(-1*(0.,1._dp)*coup1*coup2L*coup3L*int2*Mex2*ML3) & 
& +(1*(0.,1._dp)*coup1*coup2L*coup3L*int3*Mex2*ML3) & 
& +(2*(0.,1._dp)*coup1*coup2R*coup3R*int2*Mex3*ML3) & 
& +(1*(0.,1._dp)*coup1*coup2R*coup3R*int4*Mex3*ML3)

Amplitude=-Amplitude

If ((Abs(Amplitude(1))).ne.(Abs(Amplitude(1)))) Then
Amplitude=0._dp
End if
!Field Order 
! FieldOrder[1,{V, S, F},1]={External[1][gt1], AntiField[Internal[2]][i2], Internal[1][i1]}; 
! FieldOrder[1,{V, S, F},2]={External[2][gt2], Internal[3][i3], AntiField[Internal[1]][i1]}; 
! FieldOrder[1,{V, S, F},3]={AntiField[Internal[3]][i3], External[3][gt3], Internal[2][i2]}; 
! ExtraSign[1,{V, S, F},1]=-1; 
! ExtraSign[1,{V, S, F},2]=1; 
! ExtraSign[1,{V, S, F},3]=1; 
End Subroutine Amp_VERTEX_StoFF_Topology1_VSF

Subroutine Amp_VERTEX_StoFF_Topology1_VVF(Mex1,Mex2,Mex3,ML1, ML2, ML3,coup1, coup2L, coup2R, coup3L, coup3R,Amplitude)
Implicit None 
Real(dp), Intent(in) :: Mex1,Mex2,Mex3 
Complex(dp), Intent(out) :: Amplitude(2) 
Real(dp), Intent(in) :: ML1, ML2, ML3 
Complex(dp), Intent(in) :: coup1, coup2L, coup2R, coup3L, coup3R 
Complex(dp) :: int1,int2,int3,int4,int5,int6,int7,int8,int9,int10 

Amplitude = 0._dp

! Necessary Loop Integrals 
int1=SA_Cget("C0  ",Mex2**2,Mex1**2,Mex3**2,ML3**2,ML1**2,ML2**2)
int2=SA_Cget("C1  ",Mex2**2,Mex1**2,Mex3**2,ML3**2,ML1**2,ML2**2)
int3=SA_Cget("C2  ",Mex2**2,Mex1**2,Mex3**2,ML3**2,ML1**2,ML2**2)


! Now the full amplitude for the different Lorentz Parts 
! Coefficient of Mat[<u2|6|v3>] 
Amplitude(1)= & 
& +(2*(0.,1._dp)*coup1*coup2R*coup3R*int2*Mex2) & 
& +(2*(0.,1._dp)*coup1*coup2L*coup3L*int3*Mex3) & 
& +(4*(0.,1._dp)*coup1*coup2L*coup3R*int1*ML3)



! Coefficient of Mat[<u2|7|v3>] 
Amplitude(2)= & 
& +(2*(0.,1._dp)*coup1*coup2L*coup3L*int2*Mex2) & 
& +(2*(0.,1._dp)*coup1*coup2R*coup3R*int3*Mex3) & 
& +(4*(0.,1._dp)*coup1*coup2R*coup3L*int1*ML3)

If ((Abs(Amplitude(1))).ne.(Abs(Amplitude(1)))) Then
Amplitude=0._dp
End if

!Field Order 
! FieldOrder[1,{V, V, F},1]={External[1][gt1], Internal[1][i1], AntiField[Internal[2]][i2]}; 
! FieldOrder[1,{V, V, F},2]={External[2][gt2], Internal[3][i3], AntiField[Internal[1]][i1]}; 
! FieldOrder[1,{V, V, F},3]={AntiField[Internal[3]][i3], External[3][gt3], Internal[2][i2]}; 
! ExtraSign[1,{V, V, F},1]=1; 
! ExtraSign[1,{V, V, F},2]=1; 
! ExtraSign[1,{V, V, F},3]=1; 
End Subroutine Amp_VERTEX_StoFF_Topology1_VVF

Subroutine SquareAmp_StoFF(Mex1,Mex2,Mex3,Amplitude,AmplitudeC,AmpSquared)
Implicit None 
Real(dp), Intent(in) :: Mex1,Mex2,Mex3 
Complex(dp), Intent(in) :: Amplitude(2), AmplitudeC(2) 
Real(dp), Intent(out) :: AmpSquared 
Real(dp) :: LorentzFactor 
 
AmpSquared = 0._dp 

! Mat[<u2|6|v3>] x Mat[<u2|6|v3>]
LorentzFactor = (Mex1**2 - Mex2**2 - Mex3**2)/4._dp 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(1)*Conjg(AmplitudeC(1)) 

! Mat[<u2|6|v3>] x Mat[<u2|7|v3>]
LorentzFactor = -(Mex2*Mex3)/2._dp 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(1)*Conjg(AmplitudeC(2)) 

! Mat[<u2|7|v3>] x Mat[<u2|6|v3>]
LorentzFactor = -(Mex2*Mex3)/2._dp 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(2)*Conjg(AmplitudeC(1)) 

! Mat[<u2|7|v3>] x Mat[<u2|7|v3>]
LorentzFactor = (Mex1**2 - Mex2**2 - Mex3**2)/4._dp 
AmpSquared = AmpSquared + LorentzFactor*Amplitude(2)*Conjg(AmplitudeC(2)) 
End Subroutine SquareAmp_StoFF
End Module DecaySFF
