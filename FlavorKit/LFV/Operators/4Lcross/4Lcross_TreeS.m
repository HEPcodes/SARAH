(* Code automatically generated by 'PreSARAH' *) 
(* Expressions for amplitudes are obtained by FeynArts/FormCalc *) 
(* This file is supposed to be loaded and used by SARAH *) 
(* Created at 15:56 on 16.12.2015 *) 
 
 
PrintDebug["   ... ",TreeS4Lcross]; 
NamesParticles =  {ChargedLepton, bar[ChargedLepton], ChargedLepton, bar[ChargedLepton]}; 
 NamesOperators =  {TSO4lSLLcross, TSO4lSRRcross, TSO4lSRLcross, TSO4lSLRcross, TSO4lVRRcross, TSO4lVLLcross, TSO4lVRLcross, TSO4lVLRcross, TSO4lTLLcross, TSO4lTLRcross, TSO4lTRLcross, TSO4lTRRcross}; 
 NeglectInsertionOrderTree[TreeS4Lcross] =  {}; 
NeglectCrossedDiagrams[TreeS4Lcross] = False; 
NameProcess = TreeS4Lcross; 
 
Generate[TreeS4Lcross][file_]:=Block[{i,j,k}, 
 

 (* Creating all possible processes; extract information about involved masses/couplings *) 


(* ------------------------------- *)
(* {ChargedLepton, bar[ChargedLepton], ChargedLepton, bar[ChargedLepton]} *)
(* ------------------------------- *)
 
GetInformtion4FermionProcess[ChargedLepton,bar[ChargedLepton],ChargedLepton,bar[ChargedLepton],TreeS4Lcross,file]; 
NeededMassesAll=Intersection[NeededMasses];
NeededCouplingsAll=Intersection[NeededCouplings];
WriteCodeObservablePreSARAH[TreeS4Lcross][NeededMassesAll,NeededCouplingsAll,TreeContributionsScalar,TreeContributionsVector,WaveContributionsScalar,WaveContributionsVector,WaveContributionsPhoton,PenguinContributionsScalar,PenguinContributionsVector,PenguinContributionsPhoton,BoxContributions,file]; 
NeededMassAllSaved[TreeS4Lcross] = masses 
]; 

WriteCodeObservablePreSARAH[TreeS4Lcross][masses_,couplings_,treeScalar_,treeVector_,waveScalar_,waveVector_,wavePhoton_,penguinScalar_,penguinVector_,penguinPhoton_,box_,file_] :=Block[{i,j,k,fermions,scalars}, 
 
NeededMassesAllSaved[TreeS4Lcross] = masses; 
NeededCouplingsAllSaved[TreeS4Lcross] = couplings; 
NeededCombinations[TreeS4Lcross] = {{3, 1, 2, 2}, {3, 2, 1, 1}, {3, 2, 1, 2}, {3, 1, 2, 1}}; 
PrintDebug["     writing SPheno code for ",TreeS4Lcross]; 
MakeSubroutineTitle["CalculateTreeS4Lcross",Flatten[{masses,couplings}],{"gt1","gt2","gt3","gt4","OnlySM"}, 
{"TSO4lSLLcross", "TSO4lSRRcross", "TSO4lSRLcross", "TSO4lSLRcross", "TSO4lVRRcross", "TSO4lVLLcross", "TSO4lVRLcross", "TSO4lVLRcross", "TSO4lTLLcross", "TSO4lTLRcross", "TSO4lTRLcross", "TSO4lTRRcross"},file]; 
WriteString[file,"! ---------------------------------------------------------------- \n"]; 
WriteString[file,"! Code based on automatically generated SARAH extensions by 'PreSARAH' \n"]; 
WriteString[file,"! Expressions for amplitudes are obtained by FeynArts/FormCalc \n"]; 
WriteString[file,"! Based on user input for process TreeS4Lcross \n"]; 
WriteString[file,"! 'PreSARAH' output has been generated  at 15:56 on 16.12.2015 \n"]; 
WriteString[file,"! ---------------------------------------------------------------- \n \n"]; 
 
 
WriteString[file,"Implicit None \n"]; 
MakeVariableList[Flatten[{couplings,masses}],",Intent(in)",file];
WriteString[file,"Integer,Intent(in) :: gt1, gt2,gt3,gt4 \n"];
WriteString[file,"Logical, Intent(in) :: OnlySM \n"];
WriteString[file,"Integer :: iprop, i1, i2, i3, i4 \n"];
WriteString[file,"Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx4, MassEx12,MassEx22,MassEx32,MassEx42 \n"];
WriteString[file,"Complex(dp), Intent(out) :: TSO4lSLLcross \n"]; 
WriteString[file,"Complex(dp), Intent(out) :: TSO4lSRRcross \n"]; 
WriteString[file,"Complex(dp), Intent(out) :: TSO4lSRLcross \n"]; 
WriteString[file,"Complex(dp), Intent(out) :: TSO4lSLRcross \n"]; 
WriteString[file,"Complex(dp), Intent(out) :: TSO4lVRRcross \n"]; 
WriteString[file,"Complex(dp), Intent(out) :: TSO4lVLLcross \n"]; 
WriteString[file,"Complex(dp), Intent(out) :: TSO4lVRLcross \n"]; 
WriteString[file,"Complex(dp), Intent(out) :: TSO4lVLRcross \n"]; 
WriteString[file,"Complex(dp), Intent(out) :: TSO4lTLLcross \n"]; 
WriteString[file,"Complex(dp), Intent(out) :: TSO4lTLRcross \n"]; 
WriteString[file,"Complex(dp), Intent(out) :: TSO4lTRLcross \n"]; 
WriteString[file,"Complex(dp), Intent(out) :: TSO4lTRRcross \n"]; 
WriteString[file,"Complex(dp) :: vertex1L, vertex1R, vertex2L, vertex2R \n"];
WriteString[file,"Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  \n"];
WriteString[file,"Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  \n"];
WriteString[file,"Complex(dp) ::  chargefactor  \n"];
WriteString[file,"Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R \n\n"];

WriteString[file,"Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 \n\n"];

WriteString[file,"Iname=Iname+1 \n"];
WriteString[file,"NameOfUnit(Iname)='CalculateTreeS4Lcross' \n
"];
 
AddCalcSquaredMasses[masses,file]; 
(* Initaliziation *)
WriteString[file,"Finite=1._dp \n"];
WriteString[file,"MassEx1="<>SPhenoMass[ChargedLepton,gt1]<>"  \n"];
WriteString[file,"MassEx12="<>SPhenoMassSq[ChargedLepton,gt1]<>" \n"];
WriteString[file,"MassEx2="<>SPhenoMass[bar[ChargedLepton],gt2]<>"  \n"];
WriteString[file,"MassEx22="<>SPhenoMassSq[bar[ChargedLepton],gt2]<>" \n"];
WriteString[file,"MassEx3="<>SPhenoMass[ChargedLepton,gt3]<>"  \n"];
WriteString[file,"MassEx32="<>SPhenoMassSq[ChargedLepton,gt3]<>" \n"];
WriteString[file,"MassEx4="<>SPhenoMass[bar[ChargedLepton],gt4]<>"  \n"];
WriteString[file,"MassEx42="<>SPhenoMassSq[bar[ChargedLepton],gt4]<>" \n"];
WriteString[file,"! ------------------------------ \n "];
WriteString[file,"! Amplitudes for external states \n "];
WriteString[file,"! {ChargedLepton, bar[ChargedLepton], ChargedLepton, bar[ChargedLepton]} \n "];
WriteString[file,"! ------------------------------ \n \n"];
WriteString[sphenoTeX,"\\section{External states: $"<>TeXOutput[{ChargedLepton[{gt1}], bar[ChargedLepton][{gt2}], ChargedLepton[{gt3}], bar[ChargedLepton][{gt4}]}]<>"$} \n"];
WriteString[file,"TSO4lSLLcross=0._dp \n"]; 
WriteString[file,"TSO4lSRRcross=0._dp \n"]; 
WriteString[file,"TSO4lSRLcross=0._dp \n"]; 
WriteString[file,"TSO4lSLRcross=0._dp \n"]; 
WriteString[file,"TSO4lVRRcross=0._dp \n"]; 
WriteString[file,"TSO4lVLLcross=0._dp \n"]; 
WriteString[file,"TSO4lVRLcross=0._dp \n"]; 
WriteString[file,"TSO4lVLRcross=0._dp \n"]; 
WriteString[file,"TSO4lTLLcross=0._dp \n"]; 
WriteString[file,"TSO4lTLRcross=0._dp \n"]; 
WriteString[file,"TSO4lTRLcross=0._dp \n"]; 
WriteString[file,"TSO4lTRRcross=0._dp \n"]; 
WriteDiagramsObservable[TreeS4Lcross,treeScalar, {}, {},  {}, {}, {}, {}, file];
WriteString[file,"Iname=Iname-1\n\n"]; 
WriteString[file,"End Subroutine CalculateTreeS4Lcross \n\n"]; 
]; 
AddTreeResultPreSARAH[TreeS4Lcross][prop_,top_,type_,file_]:=Block[{}, 

 (* This routine returns the generic expression for the amplitude of a given triangle diagram *) 
 
Switch[prop,
V, (* Vector penguins *) 
Return[]; (* not necessary *) ,
S, (* Scalar penguins *) 
 Switch[top,  (* Check topology *) 
  1, 
	 	 WriteStringFLB[file,"  TSO4lSLLcross=TSO4lSLLcross+ coup1L*coup2L*IMP2\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lSLLcross= & "<> StringReplace["coup1L coup2L IMP2",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lSLLcross,coup1L*coup2L*IMP2}, " ];
	 	 WriteStringFLB[file,"  TSO4lSRRcross=TSO4lSRRcross+ coup1R*coup2R*IMP2\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lSRRcross= & "<> StringReplace["coup1R coup2R IMP2",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lSRRcross,coup1R*coup2R*IMP2}, " ];
	 	 WriteStringFLB[file,"  TSO4lSRLcross=TSO4lSRLcross+ coup1R*coup2L*IMP2\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lSRLcross= & "<> StringReplace["coup1R coup2L IMP2",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lSRLcross,coup1R*coup2L*IMP2}, " ];
	 	 WriteStringFLB[file,"  TSO4lSLRcross=TSO4lSLRcross+ coup1L*coup2R*IMP2\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lSLRcross= & "<> StringReplace["coup1L coup2R IMP2",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lSLRcross,coup1L*coup2R*IMP2} " ];
	 	 WriteStringFLB[file,"  TSO4lVRRcross=TSO4lVRRcross+ 0.\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lVRRcross= & "<> StringReplace["0",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lVRRcross,0} " ];
	 	 WriteStringFLB[file,"  TSO4lVLLcross=TSO4lVLLcross+ 0.\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lVLLcross= & "<> StringReplace["0",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lVLLcross,0} " ];
	 	 WriteStringFLB[file,"  TSO4lVRLcross=TSO4lVRLcross+ 0.\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lVRLcross= & "<> StringReplace["0",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lVRLcross,0} " ];
	 	 WriteStringFLB[file,"  TSO4lVLRcross=TSO4lVLRcross+ 0.\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lVLRcross= & "<> StringReplace["0",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lVLRcross,0} " ];
	 	 WriteStringFLB[file,"  TSO4lTLLcross=TSO4lTLLcross+ 0.\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lTLLcross= & "<> StringReplace["0",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lTLLcross,0} " ];
	 	 WriteStringFLB[file,"  TSO4lTLRcross=TSO4lTLRcross+ 0.\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lTLRcross= & "<> StringReplace["0",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lTLRcross,0} " ];
	 	 WriteStringFLB[file,"  TSO4lTRLcross=TSO4lTRLcross+ 0.\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lTRLcross= & "<> StringReplace["0",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lTRLcross,0} " ];
	 	 WriteStringFLB[file,"  TSO4lTRRcross=TSO4lTRRcross+ 0.\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lTRRcross= & "<> StringReplace["0",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lTRRcross,0} " ];
,
  2, 
	 	 WriteStringFLB[file,"  TSO4lSLLcross=TSO4lSLLcross+ -0.5*coup1L*coup2L*IMP2\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lSLLcross= & "<> StringReplace["-(coup1L coup2L IMP2)/2",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lSLLcross,-(coup1L*coup2L*IMP2)/2}, " ];
	 	 WriteStringFLB[file,"  TSO4lSRRcross=TSO4lSRRcross+ -0.5*coup1R*coup2R*IMP2\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lSRRcross= & "<> StringReplace["-(coup1R coup2R IMP2)/2",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lSRRcross,-(coup1R*coup2R*IMP2)/2}, " ];
	 	 WriteStringFLB[file,"  TSO4lSRLcross=TSO4lSRLcross+ 0.\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lSRLcross= & "<> StringReplace["0",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lSRLcross,0}, " ];
	 	 WriteStringFLB[file,"  TSO4lSLRcross=TSO4lSLRcross+ 0.\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lSLRcross= & "<> StringReplace["0",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lSLRcross,0} " ];
	 	 WriteStringFLB[file,"  TSO4lVRRcross=TSO4lVRRcross+ 0.5*coup1R*coup2L*IMP2\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lVRRcross= & "<> StringReplace["(coup1R coup2L IMP2)/2",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lVRRcross,(coup1R*coup2L*IMP2)/2} " ];
	 	 WriteStringFLB[file,"  TSO4lVLLcross=TSO4lVLLcross+ 0.5*coup1L*coup2R*IMP2\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lVLLcross= & "<> StringReplace["(coup1L coup2R IMP2)/2",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lVLLcross,(coup1L*coup2R*IMP2)/2} " ];
	 	 WriteStringFLB[file,"  TSO4lVRLcross=TSO4lVRLcross+ 0.\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lVRLcross= & "<> StringReplace["0",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lVRLcross,0} " ];
	 	 WriteStringFLB[file,"  TSO4lVLRcross=TSO4lVLRcross+ 0.\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lVLRcross= & "<> StringReplace["0",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lVLRcross,0} " ];
	 	 WriteStringFLB[file,"  TSO4lTLLcross=TSO4lTLLcross+ -0.125*coup1L*coup2L*IMP2\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lTLLcross= & "<> StringReplace["-(coup1L coup2L IMP2)/8",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lTLLcross,-(coup1L*coup2L*IMP2)/8} " ];
	 	 WriteStringFLB[file,"  TSO4lTLRcross=TSO4lTLRcross+ 0.\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lTLRcross= & "<> StringReplace["0",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lTLRcross,0} " ];
	 	 WriteStringFLB[file,"  TSO4lTRLcross=TSO4lTRLcross+ 0.\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lTRLcross= & "<> StringReplace["0",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lTRLcross,0} " ];
	 	 WriteStringFLB[file,"  TSO4lTRRcross=TSO4lTRRcross+ -0.125*coup1R*coup2R*IMP2\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lTRRcross= & "<> StringReplace["-(coup1R coup2R IMP2)/8",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lTRRcross,-(coup1R*coup2R*IMP2)/8} " ];
,
  3, 
	 	 WriteStringFLB[file,"  TSO4lSLLcross=TSO4lSLLcross+ -0.5*coup1L*coup2L*IMP2\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lSLLcross= & "<> StringReplace["-(coup1L coup2L IMP2)/2",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lSLLcross,-(coup1L*coup2L*IMP2)/2}, " ];
	 	 WriteStringFLB[file,"  TSO4lSRRcross=TSO4lSRRcross+ -0.5*coup1R*coup2R*IMP2\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lSRRcross= & "<> StringReplace["-(coup1R coup2R IMP2)/2",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lSRRcross,-(coup1R*coup2R*IMP2)/2}, " ];
	 	 WriteStringFLB[file,"  TSO4lSRLcross=TSO4lSRLcross+ 0.\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lSRLcross= & "<> StringReplace["0",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lSRLcross,0}, " ];
	 	 WriteStringFLB[file,"  TSO4lSLRcross=TSO4lSLRcross+ 0.\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lSLRcross= & "<> StringReplace["0",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lSLRcross,0} " ];
	 	 WriteStringFLB[file,"  TSO4lVRRcross=TSO4lVRRcross+ 0.\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lVRRcross= & "<> StringReplace["0",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lVRRcross,0} " ];
	 	 WriteStringFLB[file,"  TSO4lVLLcross=TSO4lVLLcross+ 0.\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lVLLcross= & "<> StringReplace["0",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lVLLcross,0} " ];
	 	 WriteStringFLB[file,"  TSO4lVRLcross=TSO4lVRLcross+ -0.5*coup1R*coup2L*IMP2\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lVRLcross= & "<> StringReplace["-(coup1R coup2L IMP2)/2",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lVRLcross,-(coup1R*coup2L*IMP2)/2} " ];
	 	 WriteStringFLB[file,"  TSO4lVLRcross=TSO4lVLRcross+ -0.5*coup1L*coup2R*IMP2\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lVLRcross= & "<> StringReplace["-(coup1L coup2R IMP2)/2",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lVLRcross,-(coup1L*coup2R*IMP2)/2} " ];
	 	 WriteStringFLB[file,"  TSO4lTLLcross=TSO4lTLLcross+ 0.125*coup1L*coup2L*IMP2\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lTLLcross= & "<> StringReplace["(coup1L coup2L IMP2)/8",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lTLLcross,(coup1L*coup2L*IMP2)/8} " ];
	 	 WriteStringFLB[file,"  TSO4lTLRcross=TSO4lTLRcross+ 0.\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lTLRcross= & "<> StringReplace["0",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lTLRcross,0} " ];
	 	 WriteStringFLB[file,"  TSO4lTRLcross=TSO4lTRLcross+ 0.\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lTRLcross= & "<> StringReplace["0",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lTRLcross,0} " ];
	 	 WriteStringFLB[file,"  TSO4lTRRcross=TSO4lTRRcross+ 0.125*coup1R*coup2R*IMP2\n" ];
	 	 WriteString[sphenoTeX,"  TSO4lTRRcross= & "<> StringReplace["(coup1R coup2R IMP2)/8",SA`SPhenoTeXSub]<>" \\\\ \n" ];
	 	 WriteString[FKout,"  {TSO4lTRRcross,(coup1R*coup2R*IMP2)/8} " ];
];]; 
]; 


